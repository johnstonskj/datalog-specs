<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Processing Instructions - Datalog Specifications</title>
        <!-- Custom HTML head -->
<link   rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
        integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs"
        crossorigin="anonymous">
<script defer
        src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
        integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
        crossorigin="anonymous"></script>
<script defer
        src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
        integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
        crossorigin="anonymous"></script>

<script defer>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "\\(", right: "\\)", display: false},
            {left: "$", right: "$", display: false},
            {left: "\\[", right: "\\]", display: true}
        ]
    });
});
</script>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../specs.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../vnd_datalog_text/abstract.html"><strong aria-hidden="true">1.</strong> DATALOG-TEXT: Datalog Text Representation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../vnd_datalog_text/introduction.html"><strong aria-hidden="true">1.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/conformance.html"><strong aria-hidden="true">1.2.</strong> Conformance</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/basic_concepts.html"><strong aria-hidden="true">1.3.</strong> Basic Concepts</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar.html"><strong aria-hidden="true">1.4.</strong> Datalog Text Grammar</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_program.html"><strong aria-hidden="true">1.4.1.</strong> Program</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_facts.html"><strong aria-hidden="true">1.4.2.</strong> Relations &amp; Facts</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_constants.html"><strong aria-hidden="true">1.4.3.</strong> Types &amp; Constants</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_rules.html"><strong aria-hidden="true">1.4.4.</strong> Rules</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_atoms.html"><strong aria-hidden="true">1.4.5.</strong> Atoms &amp; Terms</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_literals.html"><strong aria-hidden="true">1.4.6.</strong> Literals</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_queries.html"><strong aria-hidden="true">1.4.7.</strong> Queries</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_pi.html" class="active"><strong aria-hidden="true">1.4.8.</strong> Processing Instructions</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_comments.html"><strong aria-hidden="true">1.4.9.</strong> Comments</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/grammar_lexical.html"><strong aria-hidden="true">1.4.10.</strong> Terminal/Lexical</a></li></ol></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/resolvers.html"><strong aria-hidden="true">1.5.</strong> Resolvers</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/pragmas.html"><strong aria-hidden="true">1.6.</strong> Pragmas</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/errors.html"><strong aria-hidden="true">1.7.</strong> Errors</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/x_security.html"><strong aria-hidden="true">1.8.</strong> Security Considerations</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/x_international.html"><strong aria-hidden="true">1.9.</strong> Internationalization Considerations</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/x_ebnf.html"><strong aria-hidden="true">1.10.</strong> Appendix: EBNF</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/x_result_forms.html"><strong aria-hidden="true">1.11.</strong> Appendix: Result Formats</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/x_iana.html"><strong aria-hidden="true">1.12.</strong> Appendix: IANA Considerations</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/x_references.html"><strong aria-hidden="true">1.13.</strong> Appendix: References</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/z_errata.html"><strong aria-hidden="true">2.</strong> Datalog Text Representation Errata</a></li><li class="chapter-item expanded "><a href="../vnd_datalog_text/z_translations.html"><strong aria-hidden="true">3.</strong> Datalog Text Representation Translations</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Datalog Specifications</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/johnstonskj/datalog-specs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="processing-instructions"><a class="header" href="#processing-instructions">Processing Instructions</a></h1>
<p>Processing Instructions are declarative statements that allow the parser and processor to enable and disable language features as well as load and save external relation data. </p>
<p>A conformant DATALOG-TEXT processor MUST signal the error <a href="errors.html#ERR_UNSUPPORTED_PROCESSING_INSTRUCTION"><code>ERR_UNSUPPORTED_PROCESSING_INSTRUCTION</code></a> when detecting a processing instruction identifier which they do not recognize or cannot support, even if it may be valid in some other version of this specification.</p>
<p><img src="images/processing-instruction.png" alt="processing-instruction" /></p>
<pre><code class="language-ebnf">processing-instruction  
      ::= &quot;.&quot; 
          ( pi-pragma 
          | pi-assert | pi-infer 
          | pi-input | pi-output ) 
          &quot;.&quot; ;
</code></pre>
<h2 id="strict-processing"><a class="header" href="#strict-processing">Strict Processing</a></h2>
<p>When strict processing is enabled (either by pragma or command-line) the following processing instructions MUST BE used:</p>
<ol>
<li>feature pragmas – all features required MUST BE declared before use.</li>
<li><code>assert</code> – all extensional relations MUST BE declared before use.</li>
<li><code>infer</code> – all intensional relations MUST BE declared before use.</li>
</ol>
<h2 id="processing-instruction-pragma"><a class="header" href="#processing-instruction-pragma">Processing Instruction <code>pragma</code></a></h2>
<p>A pragma is generally used to enable or disable some feature of either the parser or resolver. The first <code>predicate</code> in this production is termed the <em>pragma identifier</em>. The details of supported pragmas is in the separate section <a href="pragmas.html">§ Pragmas</a>.</p>
<p>A conformant DATALOG-TEXT processor MUST signal an error when detecting a pragma identifier which they do not recognize, even if it may be valid in some other version of this specification.</p>
<p><img src="images/pi-pragma.png" alt="pi-pragma" /></p>
<pre><code class="language-ebnf">pi-pragma
        ::= &quot;pragma&quot; predicate ( &quot;=&quot; constant )? ;
</code></pre>
<h3 id="errors"><a class="header" href="#errors">Errors</a></h3>
<ul>
<li><a href="errors.html#ERR_UNSUPPORTED_PRAGMA"><code>ERR_UNSUPPORTED_PRAGMA</code></a> – the initial predicate does not identify a supported pragma.</li>
</ul>
<h2 id="processing-instruction-assert"><a class="header" href="#processing-instruction-assert">Processing Instruction <code>assert</code></a></h2>
<p>The <code>assert</code> processing instruction declares a new relation in the extensional database. </p>
<p>The following constraints exist:</p>
<ol>
<li>the initial predicate MUST NOT be the label of an existing relation.</li>
<li>all attribute labels, if declared, MUST BE distinct.</li>
</ol>
<p>All extensional relations MUST be asserted before use in strict processing mode, an error MUST BE signaled otherwise. In non-strict mode a conforming DATALOG-TEXT processor MAY signal an error, or MAY continue processing as if the feature is enabled and infer the declaration and attribute types when the first fact is parsed. The use of this processing instruction is therefore optional, but recommended.</p>
<p><img src="images/pi-assert.png" alt="pi-assert" /></p>
<pre><code class="language-ebnf">pi-assert
        ::= &quot;assert&quot; relation-decl functional-dependency-list? ;
</code></pre>
<p>A relation declaration declares the types, and optionally the names, of the
attributes of a relation. The first predicate in <code>relation-decl</code> is the label
of the relation, the attributes themselves are defined within the following
parenthesis:</p>
<p><img src="images/relation-decl.png" alt="relation-decl" /></p>
<pre><code class="language-ebnf">relation-decl
        ::= predicate attribute-decl-list ;
</code></pre>
<p>Each attribute has a declared type, and may also be preceded by a predicate label.</p>
<p><img src="images/attribute-decl-list.png" alt="attribute-decl-list" /></p>
<pre><code class="language-ebnf">attribute-decl-list
        ::= &quot;(&quot; attribute-decl ( &quot;,&quot; attribute-decl )* &quot;)&quot; ;
</code></pre>
<p><img src="images/attribute-decl.png" alt="attribute-decl" /></p>
<pre><code class="language-ebnf">attribute-decl
        ::= ( predicate &quot;:&quot; )?
            ( &quot;boolean&quot; | &quot;float&quot; | &quot;decimal&quot; | &quot;integer&quot; | &quot;string&quot; ) ;
</code></pre>
<p>Note that the types <code>float</code> and <code>decimal</code> are only available if the feature <code>extended_numerics</code> is enabled.</p>
<h3 id="errors-1"><a class="header" href="#errors-1">Errors</a></h3>
<ul>
<li><a href="errors.html#ERR_INVALID_RELATION"><code>ERR_INVALID_RELATION</code></a> – the values for production <code>attribute-decl-list</code> where invalid, it was not possible to construct a compliant relation schema.</li>
<li><a href="errors.html#ERR_RELATION_ALREADY_EXISTS"><code>ERR_RELATION_ALREADY_EXISTS</code></a> – the predicate labeling the relation already exists (either as an extensional or intensional relation).</li>
</ul>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>The following declares a relation labeled <code>human</code> that has a single string attribute:</p>
<pre><code class="language-datalog">.assert human(string).
</code></pre>
<p>The following declares a relation labeled <code>human</code> that has a single string attribute, labeled as <code>name</code>:</p>
<pre><code class="language-datalog">.assert human(name: string).
</code></pre>
<p>The following is an error in that the <code>name</code> label is used for two separate attributes:</p>
<pre><code class="language-datalog">.assert human(name: string, name: string).
%% ==&gt; ERR_INVALID_RELATION
</code></pre>
<p>The following is an error, relations cannot be defined twice:</p>
<pre><code class="language-datalog">.assert human(name: string).
.assert human(first_name: string, last_name: string).
%% ==&gt; ERR_RELATION_ALREADY_EXISTS
</code></pre>
<h3 id="functional-dependencies"><a class="header" href="#functional-dependencies">Functional Dependencies</a></h3>
<p>The <code>functional-dependency-list</code> production introduces a relationship between one or more attributes on the left-hand side (determinant – a set denoted by $\small\alpha$) and one or more attributes on the right-hand side (dependent – a set denoted by $\small\beta$). This relationship denotes that for a relationship $\small R$, every valid combination of determinant values uniquely determines the value of the dependent values. The syntax for the dependency is intended to be as close to the mathematical form $\small R: \alpha \longrightarrow \beta$.</p>
<p>The following constraints exist:</p>
<ol start="2">
<li>the set of attribute identifiers comprising the set $\small\alpha$ MUST BE in $\small R$.</li>
<li>the set of attribute identifiers comprising the set $\small\beta$ MUST BE in $\small R$.</li>
<li>the same attribute identifier MUST NOT appear in both determinant and dependent.</li>
</ol>
<p>In strict processing mode this production is only valid if the corresponding language feature is enabled, an error MUST BE signaled otherwise. non-strict mode a conforming DATALOG-TEXT processor MAY signal an error, or MAY continue processing as if the feature is enabled.</p>
<p>Duplicate functional dependencies MUST NOT be treated as an error, they can be ignored; however, a DATALOG-TEXT processor MAY issue a warning on detection of duplicate values.</p>
<p><img src="images/functional-dependency-list.png" alt="functional-dependency-list" /></p>
<pre><code class="language-ebnf">functional-dependency-list
        ::= &quot;:&quot; functional-dependency ( &quot;;&quot; functional-dependency )* ;
</code></pre>
<p><img src="images/functional-dependency.png" alt="functional-dependency" /></p>
<pre><code class="language-ebnf">functional-dependency
        ::= attribute-index-list ( &quot;--&gt;&quot; | &quot;⟶&quot; ) attribute-index-list ;
</code></pre>
<p><img src="images/attribute-index-list.png" alt="attribute-index-list" /></p>
<pre><code class="language-ebnf">attribute-index-list
        ::= attribute-index ( &quot;,&quot; attribute-index )*
</code></pre>
<p>An attribute index is <em>either</em> an attribute label, if one has been declared for the relation, or an integer $\small i \in [1,|schema(R)|]$.</p>
<p><img src="images/attribute-index.png" alt="attribute-index" /></p>
<pre><code class="language-ebnf">attribute-index
        ::= integer | predicate
</code></pre>
<h4 id="errors-2"><a class="header" href="#errors-2">Errors</a></h4>
<ul>
<li><a href="errors.html#ERR_INVALID_ATTRIBUTE_INDEX"><code>ERR_INVALID_ATTRIBUTE_INDEX</code></a> –
the index (integer) is not valid within the relation’s schema. </li>
<li><a href="errors.html#ERR_INVALID_ATTRIBUTE_LABEL"><code>ERR_INVALID_ATTRIBUTE_LABEL</code></a> –
the label (predicate) is not valid within the relation’s schema. </li>
</ul>
<h4 id="examples"><a class="header" href="#examples">Examples</a></h4>
<p>Given the extensional relation <em>employee</em> the two functional dependencies in the
following are equivalent. Note that the implementation will ignore such duplicate declarations.</p>
<pre><code class="language-datalog">.feature(functional_dependencies).

.assert employee(id:integer, name:string) : id --&gt; name.
.assert employee(id:integer, name:string) : 1 ⟶ 2.
</code></pre>
<p>The following errors result from invalid attributes specified in the dependency.</p>
<pre><code class="language-datalog">.feature(functional_dependencies).

.assert employee(id:integer, name:string) : 1 ⟶ 42.
%% ==&gt; ERR_INVALID_ATTRIBUTE_INDEX
.assert employee(id:integer, name:string) : id --&gt; first_name.
%% ==&gt; ERR_INVALID_ATTRIBUTE_LABEL
</code></pre>
<h2 id="processing-instruction-infer"><a class="header" href="#processing-instruction-infer">Processing Instruction <code>infer</code></a></h2>
<p>In the same manner as <code>assert</code> above, the <code>infer</code> processing instruction declares a new relation in the intensional database. The alternate form is even more explicit in that it declares an intensional relation in terms of a previously declared extensional relation. </p>
<p>The following constraints exist:</p>
<ol>
<li>the initial predicate MUST NOT be the label of an existing extensional relation.</li>
<li>all attribute labels, if declared, MUST BE distinct.</li>
</ol>
<p>All intensional relations MUST be asserted before use in strict processing mode, an error MUST BE signaled otherwise. In non-strict mode a conforming DATALOG-TEXT processor MAY signal an error, or MAY continue processing as if the feature is enabled and infer the declaration and attribute types from rules as they are parsed. The use of this processing instruction is therefore optional, but recommended.</p>
<p><img src="images/pi-infer.png" alt="pi-infer" /></p>
<pre><code class="language-ebnf">pi-infer
        ::= &quot;infer&quot; ( relation-decl | &quot;from&quot; predicate ) ;
</code></pre>
<h3 id="errors-3"><a class="header" href="#errors-3">Errors</a></h3>
<ul>
<li><a href="errors.html#ERR_INVALID_RELATION"><code>ERR_INVALID_RELATION</code></a> – the values for
production <code>attribute-decl-list</code> where invalid, it was not possible to
construct a compliant relation schema. </li>
<li><a href="errors.html#ERR_RELATION_ALREADY_EXISTS"><code>ERR_RELATION_ALREADY_EXISTS</code></a> –
the predicate labeling the relation already exists (either as an extensional
or intensional relation). </li>
<li><a href="errors.html#ERR_PREDICATE_NOT_AN_EXTENSIONAL_RELATION"><code>ERR_PREDICATE_NOT_AN_EXTENSIONAL_RELATION</code></a>
– the predicate following the <code>from</code> keyword is not the label of an
extensional relation. </li>
</ul>
<h3 id="example-1"><a class="header" href="#example-1">Example</a></h3>
<p>The following declares a relation labeled <code>mortal</code> that has a single string attribute, labeled as <code>name</code>.</p>
<pre><code class="language-datalog">.infer mortal(name: string).
</code></pre>
<p>Alternatively the short-cut form is often more convenient but has the advantage that if the definition of <code>human</code> changes declaration changes accordingly.</p>
<pre><code class="language-datalog">.assert human(name: string).
.infer mortal from human.
</code></pre>
<p>The following error is raised as <code>humans</code> is incorrectly spelled.</p>
<pre><code class="language-datalog">.assert human(name: string).
.infer mortal from humans.
%% ==&gt; ERR_PREDICATE_NOT_AN_EXTENSIONAL_RELATION
</code></pre>
<h2 id="processing-instruction-input"><a class="header" href="#processing-instruction-input">Processing Instruction <code>input</code></a></h2>
<p>The <code>input</code> processing instruction instructs the parser to load facts for the named extensional relation from an external file. </p>
<blockquote>
<p>This specification does not determine whether loading external resources happens during parsing, at the completion of parsing, at evaluation time, or via a client initiated API call. However, as some errors (fact schema conformance for example) cannot happen until facts are loaded, this choice MAY defer the signaling of some critical errors.</p>
</blockquote>
<p><img src="images/pi-input.png" alt="pi-input" /></p>
<pre><code class="language-ebnf">pi-input
        ::= &quot;input&quot; io-details ;
</code></pre>
<p>The <code>io-details</code> production informs the parser of the expected media type for the external resource and any parameters for that media type.
The initial predicate in MUST BE the label of an extensional relation.</p>
<p>For a detailed discussion of media type handling, see <a href="resolvers.html#dataset-media-types">§ Dataset Media Types</a>.</p>
<p><img src="images/io-details.png" alt="io-details" /></p>
<pre><code class="language-ebnf">io-details
        ::= predicate parameter-list ;
</code></pre>
<p>The parameter list provides the values that are specified for a particular media type. For example, the media type <code>text/csv</code> supports two optional parameters, <code>charset</code> and <code>header</code>; the value of the header parameter MUST BE one of <code>present</code> or <code>absent</code> <span class="bibref inline"><a href="x_references.html#RFC4180">RFC4180</a></span>, section 3.</p>
<p><img src="images/parameter-list.png" alt="parameter-list" /></p>
<pre><code class="language-ebnf">parameter-list
        ::= parameter-assignment ( &quot;,&quot; parameter-assignment )* ;
</code></pre>
<p><img src="images/parameter-assignment.png" alt="parameter-assignment" /></p>
<pre><code class="language-ebnf">parameter-assignment
        ::= predicate &quot;=&quot; constant ;
</code></pre>
<h3 id="errors-4"><a class="header" href="#errors-4">Errors</a></h3>
<ul>
<li><a href="errors.html#ERR_PREDICATE_NOT_AN_EXTENSIONAL_RELATION"><code>ERR_PREDICATE_NOT_AN_EXTENSIONAL_RELATION</code></a>
– the predicate is not the label of an extensional relation, the <code>input</code>
processing instruction is only valid for extensional relations.</li>
<li><a href="errors.html#ERR_INVALID_URI"><code>ERR_INVALID_URI</code></a> – the <code>uri</code> parameter could
not be parsed, or has an unsupported scheme.</li>
<li><a href="errors.html#ERR_UNSUPPORTED_MEDIA_TYPE"><code>ERR_UNSUPPORTED_MEDIA_TYPE</code></a> – the
<code>type</code> parameter could not be parsed, or has an unsupported media type. </li>
<li><a href="errors.html#ERR_IO_INSTRUCTION_PARAMETER"><code>ERR_IO_INSTRUCTION_PARAMETER</code></a> –
another parameter provided for the type was either missing or has an
incorrect value. </li>
<li><a href="errors.html#ERR_INPUT_RESOURCE_DOES_NOT_EXIST"><code>ERR_INPUT_RESOURCE_DOES_NOT_EXIST</code></a>
– the URI could not be resolved to an accessible resource. </li>
<li><a href="errors.html#ERR_IO_SYSTEM_FAILURE"><code>ERR_IO_SYSTEM_FAILURE</code></a> – some other I/O
failure occurred. </li>
</ul>
<h3 id="examples-1"><a class="header" href="#examples-1">Examples</a></h3>
<p>In the following example the full media type is used and a parameter, allowing the resolver to pass the following request header to an HTTP request
<code>Accept: text/csv;header=absent</code></p>
<pre><code class="language-datalog">.assert human(name: string).
.input(human, uri=&quot;data/humans.csv&quot;, type=&quot;text/csv&quot;, header=absent).
</code></pre>
<p>In the following the short form of the media type is used, allowing the resolver to pass the following request header to an HTTP request
<code>Accept: text/csv</code></p>
<pre><code class="language-datalog">.assert human(name: string).
.input(human, uri=&quot;data/humans.csv&quot;, type=&quot;csv&quot;).
</code></pre>
<p>In the following no media type is present, in this case the resolver MUST follow the steps in <a href="resolvers.html">§ Resolvers</a>.</p>
<pre><code class="language-datalog">.assert human(name: string).
.input(human, uri=&quot;data/humans.csv&quot;).
</code></pre>
<p>The following error is signaled due to the media type <code>audio/mp4</code> which is not, and is unlikely to ever be, supported.</p>
<pre><code class="language-datalog">.assert human(name: string).
.input(human, uri=&quot;data/humans.csv&quot;, type=&quot;audio/mp4&quot;).
%% ==&gt; ERR_UNSUPPORTED_MEDIA_TYPE
</code></pre>
<p>The values for the <code>header</code> parameter are <code>absent</code> or <code>present</code>.</p>
<pre><code class="language-datalog">.assert human(name: string).
.input(human, uri=&quot;data/humans.csv&quot;, headers=yes_please).
%% ==&gt; ERR_IO_INSTRUCTION_PARAMETER
</code></pre>
<h2 id="processing-instruction-output"><a class="header" href="#processing-instruction-output">Processing Instruction <code>output</code></a></h2>
<p>The <code>output</code> processing instruction instructs the parser to write facts from the named intensional relation to an external file. </p>
<p>This specification does not determine whether writing to external resources happens during evaluation, at completion of evaluation, or via a client initiated API call. However, as some errors (un-writable output resource) cannot happen until intensional relations are stored, this choice MAY defer the signaling of some critical errors.</p>
<p><img src="images/pi-output.png" alt="pi-output" /></p>
<pre><code class="language-ebnf">pi-output  ::= &quot;output&quot; io-details &quot;.&quot; ;
</code></pre>
<h3 id="errors-5"><a class="header" href="#errors-5">Errors</a></h3>
<ul>
<li><a href="errors.html#ERR_PREDICATE_NOT_AN_INTENSIONAL_RELATION"><code>ERR_PREDICATE_NOT_AN_INTENSIONAL_RELATION</code></a>
– the predicate is not the label of an intensional relation, the <code>output</code>
processing instruction is only valid for intensional relations.</li>
<li><a href="errors.html#ERR_INVALID_URI"><code>ERR_INVALID_URI</code></a> – the <code>uri</code> parameter could
not be parsed, or has an unsupported scheme.</li>
<li><a href="errors.html#ERR_UNSUPPORTED_MEDIA_TYPE"><code>ERR_UNSUPPORTED_MEDIA_TYPE</code></a> – the
<code>type</code> parameter could not be parsed, or has an unsupported media type.</li>
<li><a href="errors.html#ERR_IO_INSTRUCTION_PARAMETER"><code>ERR_IO_INSTRUCTION_PARAMETER</code></a> –
another parameter provided for the type was either missing or has an
incorrect value.</li>
<li><a href="errors.html#ERR_OUTPUT_RESOURCE_NOT_WRITEABLE"><code>ERR_OUTPUT_RESOURCE_NOT_WRITEABLE</code></a>
– the URI identified a resource that could not be written to.</li>
<li><a href="errors.html#ERR_IO_SYSTEM_FAILURE"><code>ERR_IO_SYSTEM_FAILURE</code></a> – some other I/O
failure occurred.</li>
</ul>
<h3 id="examples-2"><a class="header" href="#examples-2">Examples</a></h3>
<pre><code class="language-datalog">.infer mortal(name: string).
.output(mortal, uri=&quot;data/mortals.txt&quot;).
</code></pre>
<pre><code class="language-datalog">.infer mortal(name: string).
.output(mortal, uri=&quot;data/mortals.txt&quot;, type=&quot;csv&quot;, separator=&quot;;&quot;, header=present).
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../vnd_datalog_text/grammar_queries.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../vnd_datalog_text/grammar_comments.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../vnd_datalog_text/grammar_queries.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../vnd_datalog_text/grammar_comments.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../datalog.js"></script>
        <script type="text/javascript" src="../specs.js"></script>
    </body>
</html>
