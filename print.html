<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Datalog Specifications</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
<link   rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
        integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs"
        crossorigin="anonymous">
<script defer
        src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
        integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
        crossorigin="anonymous"></script>
<script defer
        src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
        integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
        crossorigin="anonymous"></script>

<script defer>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "\\(", right: "\\)", display: false},
            {left: "$", right: "$", display: false},
            {left: "\\[", right: "\\]", display: true}
        ]
    });
});
</script>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="specs.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="vnd_datalog_text/abstract.html"><strong aria-hidden="true">1.</strong> Datalog Text Representation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="vnd_datalog_text/introduction.html"><strong aria-hidden="true">1.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/conformance.html"><strong aria-hidden="true">1.2.</strong> Conformance</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/basic_concepts.html"><strong aria-hidden="true">1.3.</strong> Basic Concepts</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar.html"><strong aria-hidden="true">1.4.</strong> Datalog Text Grammar</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_program.html"><strong aria-hidden="true">1.4.1.</strong> Program</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_facts.html"><strong aria-hidden="true">1.4.2.</strong> Relations &amp; Facts</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_constants.html"><strong aria-hidden="true">1.4.3.</strong> Types &amp; Constants</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_rules.html"><strong aria-hidden="true">1.4.4.</strong> Rules</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_atoms.html"><strong aria-hidden="true">1.4.5.</strong> Atoms &amp; Terms</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_literals.html"><strong aria-hidden="true">1.4.6.</strong> Literals</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_queries.html"><strong aria-hidden="true">1.4.7.</strong> Queries</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_pi.html"><strong aria-hidden="true">1.4.8.</strong> Processing Instructions</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_comments.html"><strong aria-hidden="true">1.4.9.</strong> Comments</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/grammar_lexical.html"><strong aria-hidden="true">1.4.10.</strong> Terminal/Lexical</a></li></ol></li><li class="chapter-item expanded "><a href="vnd_datalog_text/resolvers.html"><strong aria-hidden="true">1.5.</strong> Resolvers</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/errors.html"><strong aria-hidden="true">1.6.</strong> Errors</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/x_security.html"><strong aria-hidden="true">1.7.</strong> Security Considerations</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/x_international.html"><strong aria-hidden="true">1.8.</strong> Internationalization Considerations</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/x_ebnf.html"><strong aria-hidden="true">1.9.</strong> Appendix: EBNF</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/x_iana.html"><strong aria-hidden="true">1.10.</strong> Appendix: IANA Considerations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="vnd_datalog_text/dialects.html"><strong aria-hidden="true">1.10.1.</strong> Dialect Identifiers</a></li></ol></li><li class="chapter-item expanded "><a href="vnd_datalog_text/x_references.html"><strong aria-hidden="true">1.11.</strong> Appendix: References</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="vnd_datalog_text/z_errata.html"><strong aria-hidden="true">2.</strong> Datalog Text Representation Errata</a></li><li class="chapter-item expanded "><a href="vnd_datalog_text/z_translations.html"><strong aria-hidden="true">3.</strong> Datalog Text Representation Translations</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Datalog Specifications</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/johnstonskj/datalog-specs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="datalog-text-representation"><a class="header" href="#datalog-text-representation">Datalog Text Representation</a></h1>
<h2 id="version-xx-march-2022-draft"><a class="header" href="#version-xx-march-2022-draft">Version: XX March 2022 (Draft)</a></h2>
<p>Please check the <a href="vnd_datalog_text/z_errata.html">errata</a> for any errors or issues reported since publication.</p>
<p>The English version of this specification is the only normative version. Non-normative <a href="vnd_datalog_text/z_translations.html">translations</a> may also be available.</p>
<hr />
<h2 id="abstract"><a class="header" href="#abstract">Abstract</a></h2>
<p>This document defines a standard textual representation of a Datalog program. This allows a program to be completely written in a compact and natural text form, with abbreviations for common usage patterns and data-types. </p>
<h2 id="status-of-this-document"><a class="header" href="#status-of-this-document">Status of This Document</a></h2>
<p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document.</em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<h2 id="how-to-read-this-document"><a class="header" href="#how-to-read-this-document">How to Read This Document</a></h2>
<p><em>This section is non-normative.</em></p>
<p>TBD</p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p><em>This section is non-normative.</em></p>
<p>The content for this site is generated from a <a href="https://github.com/johnstonskj/datalog-specs">GitHub repository</a>. Discussions, comments, and errata are hosted on the specification GitHub repository’s <a href="https://github.com/johnstonskj/datalog-specs/discussions">discussion section</a>.</p>
<h2 id="terminology"><a class="header" href="#terminology">Terminology</a></h2>
<p><em>This section is non-normative.</em></p>
<ul>
<li><strong>Media Type</strong> – This specification describes an Internet Media Type <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC1590">RFC1590</a></span> that is used “<em>in order to provide open and extensible data typing and type negotiation</em>” – from <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC2616">RFC2616</a>, section 3.7</span>.</li>
<li><strong>Program</strong> – A complete Datalog entity that may be serialized into a resource in a particular representation.</li>
<li><strong>Representation</strong> – “<em>An entity included with a response that is subject to content negotiation, as described in section [removed]. There may exist multiple representations associated with a particular response status.</em>” – from <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC2616">RFC2616</a>, section 1.3</span>.</li>
<li><strong>Resource</strong> – “<em>A network data object or service that can be identified by a URI, as defined in section [removed]. Resources may be available in multiple representations (e.g. multiple languages, data formats, size, and resolutions) or vary in other ways.</em>” – from <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC2616">RFC2616</a>, section 1.3</span>.</li>
</ul>
<p>Using these terms this specification describes a particular <em>representation</em> of a Datalog <em>program</em>, whose type is identified by a unique <em>media type</em>, that may be serialized into a <em>resource</em> for storage or transfer.</p>
<p><img src="vnd_datalog_text/images/processor_terms.svg" alt="Processor Terms" /></p>
<ul>
<li><strong>Application</strong> – This denotes some software component that requires the ability to download, read, and act upon Datalog resources. To accomplish this the application has to interact with the <em>processor</em>.</li>
<li><strong>Processor</strong> – A software component that provides at lease the <em>parser</em> and <em>resolver</em> and commonly the <em>evaluator</em> as well.
<ul>
<li><strong>Parser</strong> – The subcomponent that actually parses the resource, validating syntax and well-formedness rules.</li>
<li><strong>Resolver</strong> – The subcomponent that has to resolve and make available any referenced external resources.</li>
<li><strong>Evaluator</strong> – The subcomponent that consumes the parsed program and entails intensional facts from rules. </li>
</ul>
</li>
</ul>
<p>Using these terms this specification describes the requirements of the <em>parser</em> to correctly produce some representation of the program provided to it, and also the <em>resolver</em> requirements for retrieving external resources. </p>
<h2 id="datalog-naming-convention"><a class="header" href="#datalog-naming-convention">Datalog Naming Convention</a></h2>
<p>When we talk specifically about the Datalog language it is common to represent it in a roman serif face as
$\small\text{Datalog}$. This allows the distinction of talking in general about Datalog in the abstract vs. the actual
semantics of the language $\small\text{Datalog}$.</p>
<p>This core $\small\text{Datalog}$ language has many documented extensions that provide additional flexibility, conciseness, or
expressiveness. These <em>languages</em>, <em>sub-languages</em>, <em>extensions</em>, or <em>dialects</em> are usually labeled by adding a superscript
symbol that identifies the specific extension. For example, $\small\text{Datalog}^{\lnot}$ is
the language extended with negation of literals, $\small\text{Datalog}^{\Gamma}$ is the language
extended with type checking on attributes, and $\small\text{Datalog}^{\lnot,\theta}$ is the language
extended with negation of literals <em>and</em> arithmetic literals. The order of superscript symbols is
irrelevant.</p>
<table><thead><tr><th>Language</th><th>Introduces</th><th>Symbols</th></tr></thead><tbody>
<tr><td>$\small\text{Datalog}^{\lnot}$</td><td>negation of literals in rule bodies</td><td><code>!</code>, <code>NOT</code>, <code>￢</code></td></tr>
<tr><td>$\small\text{Datalog}^{\lor}$</td><td>disjunction in rule heads</td><td><code>;</code>, <code>OR</code>, <code>∨</code></td></tr>
<tr><td>$\small\text{Datalog}^{\bot}$</td><td>rules as constraints, i.e. no body</td><td>N/A</td></tr>
<tr><td>$\small\text{Datalog}^{\Gamma}$</td><td>typed attributes for relations</td><td>N/A</td></tr>
<tr><td>$\small\text{Datalog}^{\theta}$</td><td>arithmetic literals in rule bodies</td><td><code>=</code>, <code>!=</code>, <code>≠</code>, &lt;<code>, </code>&lt;=<code>, </code>≤<code>, </code>&gt;<code>, </code>&gt;=<code>, </code>≥<code>, </code>*=<code>, </code>≛`</td></tr>
<tr><td>$\small\text{Datalog}^{\rightarrow}$</td><td>functional dependency processing instruction</td><td><code>--&gt;</code>, <code>⟶</code></td></tr>
</tbody></table>
<p>When referring to the specifics of the language we will use the common format $\small\text{Datalog}$ with
superscripts as necessary to identify specific language extensions being used.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conformance"><a class="header" href="#conformance">Conformance</a></h1>
<p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p>
<p>The keywords <em>MAY</em>, <em>MUST</em>, <em>MUST NOT</em>, <em>RECOMMENDED</em>, <em>SHOULD</em>, and <em>SHOULD NOT</em> in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a> <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC2119">RFC2119</a></span> <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC8174">RFC8174</a></span> when, and only when, they appear in all capitals, as shown here.</p>
<p>A conforming Datalog <em>resource</em> is a Unicode string that MUST conform to the grammar and additional constraints defined in section <a href="vnd_datalog_text/grammar.html">1.4. Datalog Text Grammar</a>, starting with the <code>program</code> production. </p>
<p>A conforming Datalog <em>parser</em> MUST ensure the resource it is provided is a conforming Datalog resource, signalling error conditions specified herein. Additionally, a conforming <em>resolver</em> MUST be able to convert paths to URIs <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC3986">RFC3986</a></span> and retrieve the identified resource on behalf of the parser.</p>
<h2 id="media-type-and-content-encoding"><a class="header" href="#media-type-and-content-encoding">Media Type and Content Encoding</a></h2>
<p>The media type of Datalog text document is <code>application/vnd.datalog+text</code>. The content encoding of a Datalog text document is always UTF-8. For complete details, see appendix <a href="vnd_datalog_text/x_iana.html">IANA Considerations</a>.</p>
<h3 id="features-parameter"><a class="header" href="#features-parameter"><code>features</code> Parameter</a></h3>
<p>The optional “features” parameter allows the transport to identify language features used within the representation. The value of this parameter is a comma-separated list of feature identifiers supported by this specification. If this parameter is specified more than once it’s values MUST be aggregated into a set, removing duplicates.</p>
<p>Therefore, the type <code>application/vnd.datalog+text;features=negation</code> denotes a document with the following processing instruction.</p>
<pre><code class="language-datalog">.features(negation).
</code></pre>
<p>The purpose of this parameter is to save a client from having to parse a document if the features identified in the parameter are unsupported by them.</p>
<h3 id="dialect-parameter"><a class="header" href="#dialect-parameter"><code>dialect</code> Parameter</a></h3>
<p>The “dialect” parameter identifies the tool which generated the document, there are some existing tools with extensive usage that deviate from this core specification. An initial set of identifiers is included in the <em>non-normative</em> <a href="vnd_datalog_text/dialects.html">Dialect Identifiers</a>.</p>
<p>If this parameter is specified more than once, the first value MUST be used and any subsequent value MUST be discarded.</p>
<h2 id="processing-instructions"><a class="header" href="#processing-instructions">Processing Instructions</a></h2>
<p>Once a resource has been accepted for parsing it MAY include one or more <a href="vnd_datalog_text/grammar_pi.html">processing instructions</a> that need to be executed before the handling of actual program data. These processing instructions, while not a part of the program per se, MAY alter the behavior of the program and MUST be handled by any parser. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="basic-concepts"><a class="header" href="#basic-concepts">Basic Concepts</a></h1>
<p>A Datalog <strong>Program</strong> $\small P$ is a tuple comprising the <strong>Extensional</strong> database, EDB, or  $\small D_{E}$, the
<strong>Intensional</strong> database, IDB, or  $\small D_{I}$, and a set of queries $\small Q$.</p>
<p>$$\tag{0}\small P=( D_E, D_I, Q )$$</p>
<p>The extensional database in turn is a set of <em>relations</em> each of which is a set of <em>facts</em> (<em>ground atoms</em>). The intensional database is a set of <em>rules</em> that derive additional facts into intensional <em>relations</em> via entailment. </p>
<p>Every relation $\small r$ has a schema that describes a set of attributes $\small \lbrace \alpha_1, \ldots, \alpha_j \rbrace$, and each attribute may be labeled, and may also have a type. In general, we refer to attributes by index, a value in $\small 1, \cdots, j$.</p>
<p>Datalog <strong>Rules</strong> $\small R$ are built from a language $\small \mathcal{L}=( \mathcal{C},\mathcal{P},\mathcal{V})$ that contains the</p>
<ul>
<li>$\small \mathcal{C}$ — the finite sets of symbols for all constant values; e.g. hello, “hi” 123,</li>
<li>$\small \mathcal{P}$ — the finite set of alphanumeric character strings that begin with a lowercase character; e.g. human, size, a,</li>
<li>$\small \mathcal{V}$ — the finite set of alphanumeric character strings that begin with an uppercase character; e.g. X, A, Var.</li>
</ul>
<p>Atoms are comprised of a label, $\small p \in \mathcal{P}$, and a tuple of terms. A set of atoms form a Relation if each conforms to the schema of the relation. The form of an individual atom is as follows:</p>
<p>$$\tag{ix}\small p(t_1, \ldots, t_k)$$</p>
<p>Terms, mentioned above, may be constant values or variables such that $\small\mathcal{T}=\mathcal{C}\cup\mathcal{V}\cup\bar{t}$ where $\small\bar{t}$ represents an anonymous variable.</p>
<p>Literals within the body of a rule, represent sub-goals that are the required to be true for the rule’s head to be considered true. A literal may be an atom (termed a relational literal) or, in $\small\text{Datalog}^{\theta}$, a conditional expression (termed an arithmetic literal),</p>
<p>Any ground rule where $\small m=1$ and where $\small n=0$ is termed a Fact as it is true by nature of having an empty body, or alternatively we may consider the body be comprised of the truth value $\small\top$.</p>
<p>An atom may be also used as a Goal or Query clause in that its constant and variable terms may be used to match facts from the known facts or those that may be inferred from the set of rules introduced. A ground goal is simply determining that any fact exists that matches all the constant values provided and will return true or false. In the case that one or more variables exist a set of facts will be returned that match the expressed constants and provide the corresponding values for the variables.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="datalog-text-grammar"><a class="header" href="#datalog-text-grammar">Datalog Text Grammar</a></h1>
<p>A Datalog resource is a Unicode<span class="bibref inline"><a href="vnd_datalog_text/x_references.html#UNICODE">UNICODE</a></span> character string encoded in UTF-8. Unicode code points only in the range <code>U+0</code> to <code>U+10FFFF</code> inclusive are allowed.</p>
<p><strong>White space</strong> (Unicode category <strong>Zs</strong>, tab <code>U+0009</code> and <code>EOL</code>) is used to separate two terminals which would otherwise be (mis-)recognized as one terminal. White space is significant in the production <code>literal-string</code> (see <a href="vnd_datalog_text/grammar_constants.html">Types &amp; Constants</a>).</p>
<p><strong>Comments</strong> in a Datalog document take the form of <code>%</code> and continue to the end of line (<code>EOL</code>) or end of file if there is no end of line after the comment marker. </p>
<p>Comments are treated as white space.</p>
<p>The EBNF used here is defined in XML 1.0 <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#EBNF-NOTATION">EBNF-NOTATION</a></span> with the addition that each rule in the grammar ends with a semicolon character <code>;</code>. The amended rule for <code>symbol</code> is shown below.</p>
<pre><code class="language-ebnf">symbol ::= expression &quot;;&quot;
</code></pre>
<p>The following are the detailed sections of the grammar.</p>
<ul>
<li><a href="vnd_datalog_text/grammar_program.html">Program</a></li>
<li><a href="vnd_datalog_text/grammar_facts.html">Relations &amp; Facts</a></li>
<li><a href="vnd_datalog_text/grammar_constants.html">Types &amp; Constants</a></li>
<li><a href="vnd_datalog_text/grammar_rules.html">Rules</a></li>
<li><a href="vnd_datalog_text/grammar_atoms.html">Atoms &amp; Terms</a></li>
<li><a href="vnd_datalog_text/grammar_literals.html">Literals</a></li>
<li><a href="vnd_datalog_text/grammar_queries.html">Queries</a></li>
<li><a href="vnd_datalog_text/grammar_pi.html">Processing Instructions</a></li>
<li><a href="vnd_datalog_text/grammar_comments.html">Comments</a></li>
<li><a href="vnd_datalog_text/grammar_lexical.html">Terminal/Lexical</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="program"><a class="header" href="#program">Program</a></h1>
<p>A program ($\small P$) consists of a set of facts that comprise the extensional database ($\small D_E$), a list of rules that comprise the intensional database ($\small D_I$), and possibly a set of queries ($\small Q$) to interrogate the result of any reasoning performed over the program.</p>
<p><img src="vnd_datalog_text/images/program.png" alt="program" /></p>
<pre><code class="language-ebnf">program ::= processing-instruction* ( fact | rule | query )* ;
</code></pre>
<p>A program consists of a single file containing facts, rules, and queries as well as any additional files referenced via <em>processing instructions</em>.</p>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<pre><code class="language-datalog">.assert human(string).
.infer mortal from human.

human(socrates).

mortal(X) :- human(X).

?- mortal(socrates).
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relations--facts"><a class="header" href="#relations--facts">Relations &amp; Facts</a></h1>
<p>Facts <strong>must</strong> be expressed in the form of ground atoms and so they have a specific rule rather than a constrained form of the <code>atom</code> rule.</p>
<p><img src="vnd_datalog_text/images/fact.png" alt="fact" /></p>
<pre><code class="language-ebnf">fact    ::= predicate ( &quot;(&quot; constant ( &quot;,&quot; constant )* &quot;)&quot; )? &quot;.&quot; ;
</code></pre>
<p>A predicate is the identifier shared by a fact and relation.</p>
<p><img src="vnd_datalog_text/images/predicate.png" alt="predicate" /></p>
<pre><code class="language-ebnf">predicate
        ::= LC_ALPHA ( ALPHA | DIGIT | &quot;_&quot; )* ;
</code></pre>
<h2 id="example-1"><a class="header" href="#example-1">Example</a></h2>
<p>The following demonstrates a simple fact denoting that the constant <code>brooke</code> representing some
individual is the parent of some individual represented by the constant <code>&quot;Xerces&quot;</code>.</p>
<pre><code class="language-datalog">parent(&quot;Xerces&quot;, brooke).
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="types--constants"><a class="header" href="#types--constants">Types &amp; Constants</a></h1>
<p>Constants are supported in three types, String, Numbers, and Boolean. Whereas some definitions of
Datalog introduce an additional Identifier type, ASDI treats these as <em>short strings</em> that can
safely be expressed without quotes; therefore, the values <code>xerces</code> and <code>&quot;xerces&quot;</code> are equivalent.</p>
<p><img src="vnd_datalog_text/images/constant.png" alt="constant" /></p>
<pre><code class="language-ebnf">constant
        ::= string | number | boolean ;
</code></pre>
<h2 id="strings"><a class="header" href="#strings">Strings</a></h2>
<p>Strings are described in both the identifier and quoted form in the <code>string</code> rule.</p>
<p>Strings SHOULD NOT contain characters from the Unicode categories <strong>Cc</strong> (Control)
with the exception of <code>#x09</code> tab, <code>#x0A</code> line feed, and <code>#x0D</code> carriage return, <strong>Cf</strong>
(format), <strong>Co</strong> (Private Use), or <strong>Cs</strong> (Surrogate). These characters and any other
non-printable characters SHOULD be included using the escape format: <code>\t</code>, <code>\n</code>,
<code>\r</code>, <code>\u{XXXX}</code>, or <code>\U{XXXXXXXX}</code>.</p>
<p><img src="vnd_datalog_text/images/string.png" alt="string" /></p>
<pre><code class="language-ebnf">string  ::= identifier-string | literal-string ;
</code></pre>
<p><img src="vnd_datalog_text/images/identifier-string.png" alt="identifier-string" /></p>
<pre><code class="language-ebnf">identifier-string
        ::= predicate ( &quot;:&quot; ALPHA ( ALPHA | DIGIT | &quot;_&quot; * )? ) ;
</code></pre>
<p><img src="vnd_datalog_text/images/literal-string.png" alt="literal-string" /></p>
<pre><code class="language-ebnf">literal-string
        ::= DQUOTE ( string-escape | [^#x22] )* DQUOTE ;
</code></pre>
<p><img src="vnd_datalog_text/images/string-escape.png" alt="string-escape" /></p>
<pre><code class="language-ebnf">string-escape
        ::= &quot;\\&quot; ( DQUOTE | [tnr] )
        | &quot;\u{&quot; HEXDIGIT HEXDIGIT HEXDIGIT HEXDIGIT
              ( HEXDIGIT HEXDIGIT HEXDIGIT HEXDIGIT )? &quot;}&quot; ;
</code></pre>
<h2 id="numbers"><a class="header" href="#numbers">Numbers</a></h2>
<p>Numeric values in ASDI take one of three forms, integers, decimal values, and floating point values.</p>
<p><img src="vnd_datalog_text/images/number.png" alt="number" /></p>
<pre><code class="language-ebnf">number  ::= float | decimal | integer
</code></pre>
<p>Integer values in ASDI are signed, 64-bit values (<code>i64</code>).</p>
<p><img src="vnd_datalog_text/images/integer.png" alt="integer" /></p>
<pre><code class="language-ebnf">integer ::= ( &quot;+&quot; | &quot;-&quot; )? DIGIT+
</code></pre>
<p>Decimal values in ASDI are … TBD.</p>
<p><img src="vnd_datalog_text/images/decimal.png" alt="decimal" /></p>
<pre><code class="language-ebnf">decimal ::= integer &quot;.&quot; DIGIT+
</code></pre>
<p>Floating point values in ASDI are 64-bit IEEE floats (<code>f64</code>).</p>
<p><img src="vnd_datalog_text/images/float.png" alt="float" /></p>
<pre><code class="language-ebnf">float   ::= decimal ( &quot;e&quot; | &quot;E&quot; ) integer
</code></pre>
<h2 id="booleans"><a class="header" href="#booleans">Booleans</a></h2>
<p>Boolean values may also be represented using <code>⊤</code> (down tack <code>\u{22a4}</code>) for true, and <code>⊥</code> (up tack
<code>\u{22a5}</code>) for false where this may improve readability.</p>
<p><img src="vnd_datalog_text/images/boolean.png" alt="boolean" /></p>
<pre><code class="language-ebnf">boolean ::= ( &quot;true&quot;  | &quot;⊤&quot; ) 
        |   ( &quot;false&quot; | &quot;⊥&quot; ) ;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rules"><a class="header" href="#rules">Rules</a></h1>
<p>As facts are syntactically distinct from rules in the text representation there is no need for empty
bodies – all rules <strong>must</strong> have at least one literal. Material implication may be written using
the Unicode character <code>⟵</code> (long leftwards arrow<code>\u{27f5}</code>).</p>
<p><img src="vnd_datalog_text/images/rule.png" alt="rule" /></p>
<pre><code class="language-ebnf">rule    ::= ( head | &quot;⊥&quot; )? ( &quot;:-&quot; | &quot;&lt;-&quot; | &quot;⟵&quot; ) body &quot;.&quot; ;
</code></pre>
<p>The head of a rule is a disjunction of atoms, or in the case of a constraint the head may is
optional or replaced by the value <code>&quot;⊥&quot;</code>.</p>
<p><img src="vnd_datalog_text/images/head.png" alt="head" /></p>
<pre><code class="language-ebnf">head    ::= ( atom ( ( &quot;;&quot; | &quot;|&quot; | &quot;OR&quot; | &quot;∨&quot; ) atom )* ) ;
</code></pre>
<p>The body of a rule is comprised of one, or more, literals.</p>
<p><img src="vnd_datalog_text/images/body.png" alt="body" /></p>
<pre><code class="language-ebnf">body    ::= literal ( ( &quot;,&quot; | &quot;&amp;&quot; | &quot;AND&quot; | &quot;∧&quot; ) literal )* ;
</code></pre>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<p>The following sets of rules are equivalent.</p>
<pre><code class="language-datalog">ancestor(X, Y) :- parent(X, Y).
ancestor(X, Y) &lt;- parent(X, Y).
ancestor(X, Y) ⟵ parent(X, Y).

movie_star(X) :- star(X)  ,  movie_cast_member(X, _, _).
movie_star(X) :- star(X)  &amp;  movie_cast_member(X, _, _).
movie_star(X) :- star(X) AND movie_cast_member(X, _, _).
movie_star(X) :- star(X)  ∧  movie_cast_member(X, _, _).
</code></pre>
<p>As described in the abstract syntax it is an error to use an extensional relation in the head of
a rule. The following will generate an error:</p>
<pre><code class="language-datalog">parent(&quot;Xerces&quot;, brooke).

parent(X,Y) :- father(X,Y).
</code></pre>
<p>The language feature <code>disjunction</code> corresponds to the language $\small\text{Datalog}^{\lor}$ and
allows multiple atoms to appear in the rule’s head with the semantics that these are choices. This
syntax will not be accepted unless the feature is enabled.</p>
<p>The following describes the rule that <em>if X is a parent then X is <strong>either</strong> a
father <strong>or</strong> mother</em>.</p>
<pre><code class="language-datalog">.feature(disjunction).

father(X) ;  mother(X) :- parent(X).
father(X) |  mother(X) :- parent(X).
father(X) OR mother(X) :- parent(X).
father(X) ⋁  mother(X) :- parent(X).
</code></pre>
<p>As the use of disjunction in this position in the head is <em>inclusive</em> it is considered that any rule as above can be transformed
into the following standard form. Clearly, in this case this is not the expected semantics which would require
an exclusive disjunction, the language $\small\text{Datalog}^{\oplus}$. Because the semantics may
cause such confusion ASDI does not do this transformation by default.</p>
<pre><code class="language-datalog">father(X) :- parent(X).
mother(X) :- parent(X).
</code></pre>
<p>The language feature <code>constraints</code> corresponds to the language $\small\text{Datalog}^{\Leftarrow}$ and
allows the specification of rules with no head. In this case the material implication symbol is
<strong>required</strong>, the falsum value is optional for readability, therefore the following rules are
equivalent.</p>
<pre><code class="language-datalog">.feature(constraints).

:- alive(X) AND dead(X).
⊥ ⟵ alive(X) ∧ dead(X).
</code></pre>
<h2 id="safety"><a class="header" href="#safety">Safety</a></h2>
<p>ASDI will disallow the addition of rules that are unsafe according to the abstract syntax. The
following are examples of unsafe rules:</p>
<ul>
<li><code>a(X) :- b(Y).</code> — because <code>X</code> appears as a distinguished variable but does not appear in a
positive relational literal, error
<a href="vnd_datalog_text/error/enum.Error.html#variant.NegativeVariablesNotAlsoPositive"><code>HeadVariablesMissingInBody</code></a>.</li>
<li><code>a(X) :- b(Y), NOT b(X).</code> — because <code>X</code> appears in a negated literal but does not appear in a
positive relational literal, error
<a href="vnd_datalog_text/error/enum.Error.html#variant.NegativeVariablesNotAlsoPositive"><code>NegativeVariablesNotAlsoPositive</code></a>.</li>
<li><code>a(X) :- b(Y), X &lt; Y.</code> — Because <code>X</code> appears in an arithmetic literal but does not appear in a
positive relational literal, error
<a href="vnd_datalog_text/error/enum.Error.html#variant.ArithmeticVariablesNotAlsoPositive"><code>ArithmeticVariablesNotAlsoPositive</code></a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="atoms--terms"><a class="header" href="#atoms--terms">Atoms &amp; Terms</a></h1>
<p>The text representation of an atom is a relatively simple translation from the abstract syntax
above.</p>
<p><img src="vnd_datalog_text/images/atom.png" alt="atom" /></p>
<pre><code class="language-ebnf">atom    ::= predicate &quot;(&quot; term ( &quot;,&quot; term )* &quot;)&quot; ;
</code></pre>
<h2 id="terms"><a class="header" href="#terms">Terms</a></h2>
<p><img src="vnd_datalog_text/images/term.png" alt="term" /></p>
<pre><code class="language-ebnf">term    ::= variable | constant ;
</code></pre>
<p>Note that we explicitly separate variables into named and anonymous forms here.</p>
<h2 id="variables"><a class="header" href="#variables">Variables</a></h2>
<p><img src="vnd_datalog_text/images/variable.png" alt="variable" /></p>
<pre><code class="language-ebnf">variable
        ::= named-variable | anon-variable ;
</code></pre>
<p><img src="vnd_datalog_text/images/named-variable.png" alt="named-variable" /></p>
<pre><code class="language-ebnf">named-variable
        ::= UC_ALPHA ( ALPHA | DIGIT | &quot;_&quot; )* ;
        
anon-variable
        ::= &quot;_&quot; ;
</code></pre>
<h2 id="example-2"><a class="header" href="#example-2">Example</a></h2>
<p>The following are all valid rule body atoms.</p>
<pre><code class="language-datalog">dead(julius_caesar).
emperor(julius_caesar, rome).
emperor(X, Y).
emperor(X, rome).
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="literals"><a class="header" href="#literals">Literals</a></h1>
<p>Any valid atom is also a valid <em>positive relational</em> literal. The syntax below also allows for <em>negative</em>
literals as well as arithmetic expressions as literals. Conjunction may be written with the Unicode
character <code>∧</code> (logical and <code>\u{2227}</code>).</p>
<p><img src="vnd_datalog_text/images/literal.png" alt="literal" /></p>
<pre><code class="language-ebnf">literal ::= ( &quot;!&quot; | &quot;NOT&quot; | &quot;￢&quot; )?
            ( relational-literal | arithmetic-literal ) ;
</code></pre>
<p><img src="vnd_datalog_text/images/relational-literal.png" alt="relational-literal" /></p>
<pre><code class="language-ebnf">relational-literal
        ::= atom ;
</code></pre>
<h2 id="examples-1"><a class="header" href="#examples-1">Examples</a></h2>
<p>The following rules are all equivalent.</p>
<pre><code class="language-datalog">ancestor(X, Y) ⟵ parent(X, Z)  ,  ancestor(Z, Y).
ancestor(X, Y) ⟵ parent(X, Z)  &amp;  ancestor(Z, Y).
ancestor(X, Y) ⟵ parent(X, Z)  ∧  ancestor(Z, Y).
ancestor(X, Y) ⟵ parent(X, Z) AND ancestor(Z, Y).
</code></pre>
<p>The language feature <code>negation</code> corresponds to the language $\small\text{Datalog}^{\lnot}$ and
allows the specification of negated literals. Negation may also be written using the Unicode
character <code>￢</code> (full-width not sign <code>\u{ffe2}</code>). The following rules are equivalent.</p>
<pre><code class="language-datalog">.feature(negation).

alive(X) :- person(X), NOT dead(X).
alive(X) ⟵ person(X) ∧ ￢dead(X).
</code></pre>
<p>The following will fail as the negated rule is not considered safe ([Error::NegativeVariablesNotAlsoPositive]).</p>
<pre><code class="language-datalog">.feature(negation).

alive(X) :- NOT dead(X).
alive(X) ⟵ ￢dead(X).
</code></pre>
<h2 id="arithmetic-literals"><a class="header" href="#arithmetic-literals">Arithmetic Literals</a></h2>
<p>The language feature <code>comparisons</code> corresponds to the language $\small\text{Datalog}^{\theta}$ and
allows the use of arithmetic literals. Comparisons take place between two literals and are
currently limited to a set of common operators. Note the addition of a string match operator, this
is similar to the Perl <code>=~</code> and requires a string value/variable on the left and a string value or
variable on the right that compiles to a valid Rust regular expression. Finally, the rule <code>named-term</code>
disallows the use of anonymous variables in arithmetic literals.</p>
<p><img src="vnd_datalog_text/images/arithmetic-literal.png" alt="arithmetic-literal" /></p>
<pre><code class="language-ebnf">arithmetic-literal
        ::= operand operator operand ;
</code></pre>
<p><img src="vnd_datalog_text/images/operand.png" alt="operand" /></p>
<pre><code class="language-ebnf">operand ::= ( named-variable | constant ) ;
</code></pre>
<p><img src="vnd_datalog_text/images/operator.png" alt="operator" /></p>
<pre><code class="language-ebnf">operator
        ::= &quot;=&quot;
            | (&quot;!=&quot; | &quot;/=&quot; | &quot;≠&quot;)
            | &quot;&lt;&quot;
            | (&quot;&lt;=&quot; | &quot;≤&quot;)
            | &quot;&gt;&quot;
            | (&quot;&gt;=&quot; | &quot;≥&quot;)
            | (&quot;*=&quot; | &quot;≛&quot; | &quot;MATCHES&quot;) ;
</code></pre>
<p>The Unicode characters <code>≠</code> (not equal to <code>\u{2260}</code>), <code>≤</code> (less-than or equal to <code>\u{2264}</code>),
<code>≥</code> (greater-than or equal to <code>\u{2265}</code>, and star equals <code>\u{e2899b}</code>) may be substituted for the
common arithmetic and string operators.</p>
<p>All arithmetic operations <strong>must</strong> be between terms of the some type, such that the property
<em>compatible</em> introduce above is defined as:</p>
<p>$$\tag{xvi}\small compatible(\tau_{lhs}, \tau_{rhs}, \theta) \leftarrow \tau_{lhs} = \tau_{rhs}$$</p>
<p>Additionally, some operators are not present for all types, as shown in the table below.</p>
<table><thead><tr><th>Type</th><th><code>=</code>, <code>≠</code></th><th><code>&lt;</code>, <code>≤</code>, <code>&gt;</code>, <code>≥</code></th><th><code>≛</code></th></tr></thead><tbody>
<tr><td>String</td><td>Yes</td><td>Yes - lexical</td><td>Yes</td></tr>
<tr><td>Integer</td><td>Yes</td><td>Yes</td><td>No</td></tr>
<tr><td>Boolean</td><td>Yes</td><td>No</td><td>No</td></tr>
</tbody></table>
<h2 id="example-3"><a class="header" href="#example-3">Example</a></h2>
<p>The following is an example using arithmetic literals and the <em>car</em> relation.</p>
<pre><code class="language-datalog">.feature(comparisons).
.assert car(make: string, model: string, age: integer).

antique(X, Y) :- car(X, Y, _) AND X *= &quot;[dD]uesenberg&quot;.
antique(X, Y) :- car(X, Y, _) AND Y = &quot;model t&quot;.
antique(X, Y) :- car(X, Y, Z) AND Z &gt; 50.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="queries"><a class="header" href="#queries">Queries</a></h1>
<p>A query is simply an atom, but one identified to the system as a goal with either the prefix <code>?-</code>
or the suffix <code>?</code>.</p>
<p><img src="vnd_datalog_text/images/query.png" alt="query" /></p>
<pre><code class="language-ebnf">query   ::= ( &quot;?-&quot; atom &quot;.&quot; ) | ( atom &quot;?&quot; ) ;
</code></pre>
<h2 id="example-4"><a class="header" href="#example-4">Example</a></h2>
<p>The following queries are equivalent and will return the value of the variable <code>X</code> for any facts in
the <em>ancestor</em> relationship where the first attribute is the string value <code>&quot;xerces&quot;</code>.</p>
<pre><code class="language-datalog">?- ancestor(xerces, X).
ancestor(xerces, X)?
</code></pre>
<p>When the value <code>_</code> is used in a query it denotes an attribute of the relation that has no meaning
in either the query or the response. For example, in the following query we ask for all values of
the <em>model</em> attribute in the <em>car</em> relation where the <em>make</em> is “ford”, and ignore the age entirely.</p>
<pre><code class="language-datalog">.assert car(make: string, model: string, age: integer).

car(&quot;ford&quot;, X, _)?
</code></pre>
<p>The results of this query would not include the age column:</p>
<pre><code class="language-text">+------------+
| model      |
+============+
| edge       |
+------------+
| escort     |
+------------+
| fiesta     |
+------------+
| focus      |
+------------+
| fusion     |
+------------+
| mustang    |
+------------+
     ...
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processing-instructions-1"><a class="header" href="#processing-instructions-1">Processing Instructions</a></h1>
<p>Processing Instructions are declarative statements meant for the parser and runtime tooling, they do not affect
the meaning of the program itself.</p>
<p><img src="vnd_datalog_text/images/processing-instruction.png" alt="processing-instruction" /></p>
<pre><code class="language-ebnf">processing-instruction  
      ::= &quot;.&quot; 
          ( pi-feature 
          | pi-assert | pi-infer 
          | pi-fd 
          | pi-input | pi-output 
          | pi-pragma ) 
          &quot;.&quot; ;
</code></pre>
<h2 id="processing-instruction-feature"><a class="header" href="#processing-instruction-feature">Processing Instruction <code>feature</code></a></h2>
<p>The <code>feature</code> processing instruction determines which Datalog language is in use. Use of syntax not supported by the
selected language feature will result in errors.</p>
<p><img src="vnd_datalog_text/images/pi-feature.png" alt="pi-feature" /></p>
<pre><code class="language-ebnf">pi-feature ::= &quot;feature&quot; &quot;(&quot; feature-id ( &quot;,&quot; feature-id )* &quot;)&quot; ;
</code></pre>
<p><img src="vnd_datalog_text/images/feature-id.png" alt="feature-id" /></p>
<pre><code class="language-ebnf">feature-id
        ::= &quot;comparisons&quot;
        | &quot;constraints&quot;
        | &quot;disjunction&quot;
        | &quot;negation&quot;
        | &quot;functional_dependencies&quot;
</code></pre>
<h3 id="example-5"><a class="header" href="#example-5">Example</a></h3>
<pre><code class="language-datalog">.feature(negation).
.feature(comparisons, disjunction).
</code></pre>
<h2 id="processing-instruction-assert"><a class="header" href="#processing-instruction-assert">Processing Instruction <code>assert</code></a></h2>
<p>The <code>assert</code> processing instruction describes a new relation in the extensional database. The parser can determine
the schema for facts from their types in the database. The use of this processing instruction is therefore optional,
but recommended.</p>
<p><img src="vnd_datalog_text/images/pi-assert.png" alt="pi-assert" /></p>
<pre><code class="language-ebnf">pi-assert
        ::= &quot;assert&quot; relation-decl ;
</code></pre>
<p><img src="vnd_datalog_text/images/relation-decl.png" alt="relation-decl" /></p>
<pre><code class="language-ebnf">relation-decl
        ::= predicate &quot;(&quot; attribute-decl ( &quot;,&quot; attribute-decl )* &quot;)&quot; ;
</code></pre>
<p><img src="vnd_datalog_text/images/attribute-decl.png" alt="attribute-decl" /></p>
<pre><code class="language-ebnf">attribute-decl
        ::= ( predicate &quot;:&quot; )?
            ( &quot;boolean&quot; | &quot;float&quot; | &quot;decimal&quot; | &quot;integer&quot; | &quot;string&quot; ) ;
</code></pre>
<h3 id="example-6"><a class="header" href="#example-6">Example</a></h3>
<pre><code class="language-datalog">.assert human(name: string).
</code></pre>
<h2 id="processing-instruction-infer"><a class="header" href="#processing-instruction-infer">Processing Instruction <code>infer</code></a></h2>
<p>The <code>infer</code> processing instruction describes a new relation in the intensional database. Typically the parser
can determine the schema for relational literals from their context, The use of this processing instruction
is therefore optional, but recommended. The alternate form is more explicit in that it defines
an intensional relation in terms of a previously defined extensional relation.</p>
<p><img src="vnd_datalog_text/images/pi-infer.png" alt="pi-infer" /></p>
<pre><code class="language-ebnf">pi-infer
        ::= &quot;infer&quot; ( relation-decl | &quot;from&quot; predicate ) ;
</code></pre>
<h3 id="example-7"><a class="header" href="#example-7">Example</a></h3>
<pre><code class="language-datalog">.infer mortal(name: string).
</code></pre>
<p>Alternatively the short-cut form is often more convenient.</p>
<pre><code class="language-datalog">.assert human(name: string).
.infer mortal from human.
</code></pre>
<h2 id="processing-instruction-fd"><a class="header" href="#processing-instruction-fd">Processing Instruction <code>fd</code></a></h2>
<p>The <code>fd</code> processing instruction, short for <em>functional dependency</em>, introduces a relationship between one or more attributes on the
left-hand (determinant) side and one or more attributes on the right-hand (dependent) side. This relationship denotes
that for a relationship $\small R$ with attributes $\small a_1, \cdots, a_n$, every valid combination of determinant
values uniquely determines the value of the dependent values.</p>
<p>Note that this processing instruction is only valid if the corresponding language feature is enabled.</p>
<p><img src="vnd_datalog_text/images/pi-fd.png" alt="pi-fd" /></p>
<pre><code class="language-ebnf">pi-fd      ::= ( &quot;fd&quot; | &quot;functional_dependency&quot; ) 
            predicate &quot;:&quot;
            attribute-index-list ( &quot;--&gt;&quot; | &quot;⟶&quot; ) attribute-index-list
</code></pre>
<p><img src="vnd_datalog_text/images/attribute-index-list.png" alt="attribute-index-list" /></p>
<pre><code class="language-ebnf">attribute-index-list
        ::= attribute-index ( &quot;,&quot; attribute-index )*
</code></pre>
<p>An attribute index is <em>either</em> an attribute label, if one has been declared for the relation, or an integer $\small i \in [1,|schema(R)|]$.</p>
<p><img src="vnd_datalog_text/images/attribute-index.png" alt="attribute-index" /></p>
<pre><code class="language-ebnf">attribute-index
        ::= integer | predicate
</code></pre>
<p><strong>Constraints</strong> – given the notational form $\small R: \alpha \rightarrow \Beta$;</p>
<ol>
<li>the initial predicate <strong>must</strong> be the label of an extensional relation:
$$\small R \in D_I \land label(R)$$</li>
<li>the set of attribute identifiers comprising the set $\small \alpha$ <strong>must</strong> be in $\small R$:
$$\small \forall a \in \alpha (a \in schema(R))$$</li>
<li>the set of attribute identifiers comprising the set $\small \Beta$ <strong>must</strong> be in $\small R$:
$$\small \forall a \in \Beta (a \in schema(R))$$</li>
<li>the same attribute identifier <strong>must not</strong> appear in both determinant and dependent:
$$\small \alpha \cap \Beta = \emptyset$$</li>
</ol>
<h3 id="example-8"><a class="header" href="#example-8">Example</a></h3>
<p>Given the extensional relation <em>employee</em> the two functional dependencies in the
following are equivalent. Note that the implementation will ignore such duplicate declarations.</p>
<pre><code class="language-datalog">.feature(functional_dependencies).
.assert employee(id:integer, name:string).

.fd employee: id --&gt; name.
.fd employee: 1 ⟶ 2.
</code></pre>
<h2 id="processing-instruction-input"><a class="header" href="#processing-instruction-input">Processing Instruction <code>input</code></a></h2>
<p>The <code>input</code> processing instruction instructs the parser to load facts for the named extensional relation from an
external file. This processing instruction <strong>requires</strong> that the relation be previously defined via the <code>assert</code>
processing instruction.</p>
<p><img src="vnd_datalog_text/images/pi-input.png" alt="pi-input" /></p>
<pre><code class="language-ebnf">pi-input   ::= &quot;input&quot; io-details &quot;.&quot;
</code></pre>
<p><img src="vnd_datalog_text/images/io-details.png" alt="io-details" /></p>
<pre><code class="language-ebnf">io-details
        ::= &quot;(&quot; predicate &quot;,&quot; quoted-string
                ( &quot;,&quot; format-spec )?
            &quot;)&quot; ;
</code></pre>
<p><img src="vnd_datalog_text/images/format-spec.png" alt="format-spec" /></p>
<pre><code class="language-ebnf">format-spec
        ::= quoted-string ( &quot;,&quot; assign-list )? ;
</code></pre>
<p><img src="vnd_datalog_text/images/assign-list.png" alt="assign-list" /></p>
<pre><code class="language-ebnf">assign-list
        ::= assignment ( &quot;,&quot; assignment )* ;
</code></pre>
<p><img src="vnd_datalog_text/images/assignment.png" alt="assignment" /></p>
<pre><code class="language-ebnf">assignment
        ::= predicate &quot;=&quot; constant ;
</code></pre>
<p>the first quoted string is the type and </p>
<p>For a detailed discussion of media type handling, see <a href="vnd_datalog_text/resolvers.html#media-types">Dataset Processing</a>.</p>
<h3 id="example-9"><a class="header" href="#example-9">Example</a></h3>
<pre><code class="language-datalog">.assert human(name: string).
.input(human, &quot;data/humans.csv&quot;, &quot;csv&quot;).
</code></pre>
<h2 id="processing-instruction-output"><a class="header" href="#processing-instruction-output">Processing Instruction <code>output</code></a></h2>
<p>The <code>output</code> processing instruction instructs the parser to write facts from the named intensional relation to an
external file. This processing instruction <strong>requires</strong> that the relation be previously defined via the <code>infer</code>
processing instruction.</p>
<p><img src="vnd_datalog_text/images/pi-output.png" alt="pi-output" /></p>
<pre><code class="language-ebnf">pi-output  ::= &quot;output&quot; io-details &quot;.&quot; ;
</code></pre>
<h3 id="example-10"><a class="header" href="#example-10">Example</a></h3>
<pre><code class="language-datalog">.infer mortal(name: string).
.output(mortal, &quot;data/mortals.txt&quot;).
</code></pre>
<pre><code class="language-datalog">.infer mortal(name: string).
.output(mortal, &quot;data/mortals.txt&quot;, &quot;csv&quot;, separator=&quot;;&quot;, header=present).
</code></pre>
<h2 id="processing-instruction-pragma"><a class="header" href="#processing-instruction-pragma">Processing Instruction <code>pragma</code></a></h2>
<p><img src="vnd_datalog_text/images/pi-pragma.png" alt="pi-pragma" /></p>
<pre><code class="language-ebnf">pi-pragma
        ::= &quot;pragma&quot; predicate ( &quot;(&quot; assignment-list &quot;)&quot; )? ;
</code></pre>
<h3 id="defined-pragmas-and-keys"><a class="header" href="#defined-pragmas-and-keys">Defined Pragmas and Keys</a></h3>
<table><thead><tr><th>Pragma</th><th>Key</th><th>Value Type</th><th>Description</th></tr></thead><tbody>
<tr><td>base</td><td>iri</td><td>string</td><td>Interpreted as an absolute IRI, all other references are relative to this value.</td></tr>
</tbody></table>
<p><strong>Notes</strong></p>
<ol>
<li>If the <code>base</code> pragma is not specified then any references in the subject resource are relative to the resource location if known by the parser, or relative to the process performing the parsing.</li>
</ol>
<h3 id="example-11"><a class="header" href="#example-11">Example</a></h3>
<p>In the following case the base IRI is <em>implicit</em> and is determined by the parser to dereference the relative value “data/humans.csv”.</p>
<pre><code class="language-datalog">.assert human(string).
.input(human, &quot;data/humans.csv&quot;, &quot;csv&quot;).
</code></pre>
<p>In the following case the base IRI is <em>explicitly</em> declared and so the input for <code>human</code> is clearly “https://example.com/datalog/data/humans.csv”.</p>
<pre><code class="language-datalog">.pragma base(iri=&quot;https://example.com/datalog/&quot;).
.assert human(string).
.input(human, &quot;data/humans.csv&quot;, &quot;csv&quot;).
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comments"><a class="header" href="#comments">Comments</a></h1>
<p>Comments in Datalog are either 1) the <code>%</code> character and continue to the end of the line, or
2) C-style with <code>/*</code> to start and <code>*/</code> to end. These correspond to the same rules as Prolog.</p>
<p><img src="vnd_datalog_text/images/comment.png" alt="comment" /></p>
<pre><code class="language-ebnf">comment ::= line-comment | block-comment ;
</code></pre>
<p><img src="vnd_datalog_text/images/line-comment.png" alt="line-comment" /></p>
<pre><code class="language-ebnf">line-comment
        ::= &quot;%&quot; [^\r\n]* EOL ;
</code></pre>
<p><img src="vnd_datalog_text/images/block-comment.png" alt="block-comment" /></p>
<pre><code class="language-ebnf">block-comment
        ::= '/*' ( [^*] | '*'+ [^*/] )* '*'* '*/' ;
</code></pre>
<h2 id="example-12"><a class="header" href="#example-12">Example</a></h2>
<pre><code class="language-datalog">% Here's a comment
?- ancestor(xerces, X). % and another
?- ancestor(brooke /* and one inline */, X). % and another
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="terminallexical"><a class="header" href="#terminallexical">Terminal/Lexical</a></h1>
<p>The following are lexical rules that can be assumed by the rules above.</p>
<pre><code class="language-ebnf">EOL     ::= &quot;\n&quot; | &quot;\r&quot; &quot;\n&quot;? ;

SPACE_SEP
        ::= ? corresponds to the Unicode category 'Zs' ? ;

WHITESPACE
        ::= SPACE_SEP | &quot;\t&quot; | EOL ;

DQUOTE  ::= #x22 ;

LC_ALPHA
        ::= ? corresponds to the Unicode category 'Ll' ? ;

UC_ALPHA
        ::= ? corresponds to the Unicode category 'Lu' ? ;

TC_ALPHA
        ::= ? corresponds to the Unicode category 'Lt' ? ;

ALPHA   ::= LC_ALPHA | UC_ALPHA | TC_ALPHA ;

DIGIT   ::= ? corresponds to the Unicode category 'Nd' (decimal number) ? ;

HEXDIGIT
        ::= [0-9a-fA-F] ;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resolvers"><a class="header" href="#resolvers">Resolvers</a></h1>
<h2 id="iri-references"><a class="header" href="#iri-references">IRI References</a></h2>
<h2 id="media-types"><a class="header" href="#media-types">Media Types</a></h2>
<table><thead><tr><th>Media Type</th><th>Short Form</th><th>Parameters</th><th>Expectations</th></tr></thead><tbody>
<tr><td><code>text/csv</code></td><td><code>csv</code></td><td>charset, header</td><td>See <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC4180">RFC4180</a></span></td></tr>
<tr><td><code>text/tab-separated-values</code></td><td><code>tsv</code></td><td>?</td><td>See <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#IANA-TSV">IANA-TSV</a></span></td></tr>
<tr><td><code>application/json</code></td><td><code>json</code></td><td>N/A</td><td>See <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#RFC4627">RFC4627</a></span></td></tr>
</tbody></table>
<p><strong>Example</strong></p>
<pre><code class="language-datalog">.assert human(name: string).
.input(human, &quot;data/humans.csv&quot;, &quot;text/csv&quot;, header=present).
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="errors"><a class="header" href="#errors">Errors</a></h1>
<p>This specification expects parsers of to emit certain errors when dealing with the semantics of the resource content (we do not address low-leve lexing/parsing errors). Each instance of an error reported to the client of the parser SHOULD include a message that denotes the details of the elements involved and SHOULD, if possible, the source location.</p>
<p>The following errors MUST be supported in any parser implementation. Additional errors MAY be added, but where possible errors should be distinguished by any message associate with the error instance.</p>
<dl class="enum">
    <dt>ERR_UNSUPPORTED_DIALECT</dt>
    <dd>The dialect specified in the media type was not identified, or otherwise not supported by this parser.</dd>
    <dt>ERR_UNSUPPORTED_FEATURE</dt>
    <dd>A feature identified in the <code>features</code> processing instruction is not supported by this parser.</dd>
    <dt>ERR_INCONSISTENT_FACT_SCHEMA</dt>
    <dd>
        <p>Two facts are asserted but with different schema, or a fact is asserted with a different schema than it's declared relation.</p>
        <p>Given the following processing instruction <code>.assert human(string).</code>, the following fact is inconsistent <code>human(24).</code>
        </p>
        <p>Or, if no relation declaration exists the first instance of a fact, say <code>human("Alice").</code>, is used to infer the relation schema and thus the following fact is inconsistent <code>human(24).</code>
        </p>
    </dd>
    <dt>ERR_INCONSISTENT_RELATION_SCHEMA</dt>
    <dd>TBD</dd>
    <dt>ERR_PREDICATE_NOT_AN_EXTENSIONAL_RELATION</dt>
    <dd>TBD</dd>
    <dt>ERR_PREDICATE_NOT_AN_INTENSIONAL_RELATION</dt>
    <dd>TBD</dd>
    <dt>ERR_EXTENSIONAL_RELATION_IN_RULE_HEAD</dt>
    <dd>TBD</dd>
    <dt>ERR_HEAD_VARIABLE_NOT_IN_POSITIVE_RELATIONAL_LITERAL</dt>
    <dd>A variable that is used within the head of a rule does not also appear in a positive _relational_ literal. For example, the following is invalid: <code>a(X) :- b(Y).</code></dd>
    <dd>TBD</dd>
    <dt>ERR_INVALID_NUMBER_OF_ATOMS_IN_HEAD</dt>
    <dd>A $\small\text{Datalog}$ program requires one, and only one, atom in a rule's head.</dd>
    <dt>ERR_INVALID_TYPE</dt>
    <dd>A value was provided with an invalid type.</dd>
    <dt>ERR_INVALID_VALUE_FOR_TYPE</dt>
    <dd>A value was provided that is an invalid representation of the expected type.</dd>
    <dt>ERR_PROGRAM_NOT_STRATIFIABLE</dt>
    <dd>TBD</dd>
    <dt>ERR_ANONYMOUS_VARIABLE_NOT_ALLOWED_HERE</dt>
    <dd>TBD</dd>
    <dt>WARN_RULE_IS_ALWAYS_TRUE</dt>
    <dd>For some reason this rule will always evaluate to true.</dd>
    <dt>WARN_RULE_IS_ALWAYS_FALSE</dt>
    <dd>For some reason, this rule will always evaluate to false.</dd>
</dl>
<h2 id="resolver-errors"><a class="header" href="#resolver-errors">Resolver Errors</a></h2>
<dl class="enum">
    <dt>ERR_INVALID_URI</dt>
    <dd>TBD</dd>
    <dt>ERR_INPUT_RESOURCE_DOES_NOT_EXIST</dt>
    <dd>TBD (404), ENODEV, ENOENT, ENOTDIR[^1]</dd>
    <dt>ERR_COULD_NOT_RETRIEVE_INPUT_RESOURCE</dt>
    <dd>TBD (4xx)</dd>
    <dt>ERR_INVALID_INPUT_RESOURCE</dt>
    <dd>The resource was retrieved but it was not possible to parse it according to it's expected media type.</dd>
    <dt>ERR_OUTPUT_RESOURCE_NOT_WRITEABLE</dt>
    <dd>TBD</dd>
</dl>
<h2 id="with-negation"><a class="header" href="#with-negation">With Negation</a></h2>
<dl class="enum">
    <dt>ERR_NEGATIVE_VARIABLE_NOT_IN_POSITIVE_RELATIONAL_LITERAL</dt>
    <dd>A variable that is used within a negated literal does not also appear in a positive _relational_ literal. For example, the following is invalid: <code>a(X) :- b(Y), NOT b(X).</code></dd>
</dl>
<h2 id="with-arithmetic-literals"><a class="header" href="#with-arithmetic-literals">With Arithmetic Literals</a></h2>
<dl class="enum">
    <dt>ERR_ARITHMETIC_VARIABLE_NOT_IN_POSITIVE_RELATIONAL_LITERAL</dt>
    <dd>A variable that is used within an arithmetic literal does not also appear in a positive _relational_ literal. For example, the following is invalid: <code>a(X) :- b(Y), X < Y.</code></dd>
    <dt>ERR_INVALID_OPERATOR_FOR_TYPE</dt>
    <dd>An operator is not specified for the type of the current entity.</dd>
    <dt>ERR_INCOMPATIBLE_TYPES_FOR_OPERATOR</dt>
    <dd>The left-hand and right-hand sides of the literal are of different types and the operator cannot be used with the combination of types.</dd>
    <dt>WARN_ARITHMETIC_LITERAL_IS_ALWAYS_TRUE</dt>
    <dd>Evaluation of this literal will always return true. For example <code>1 = 1</code></dd>
    <dt>WARN_ARITHMETIC_LITERAL_IS_ALWAYS_FALSE</dt>
    <dd>Evaluation of this literal will always return false. For example <code>1 = 2</code></dd>
</dl>
<h2 id="with-constraints"><a class="header" href="#with-constraints">With Constraints</a></h2>
<p>The error <code>ERR_INVALID_NUMBER_OF_ATOMS_IN_HEAD</code> is relaxed in $\small\text{Datalog}^{\bot}$ to allow zero atoms in a rule’s head.</p>
<h2 id="with-disjunction"><a class="header" href="#with-disjunction">With Disjunction</a></h2>
<p>The error <code>ERR_INVALID_NUMBER_OF_ATOMS_IN_HEAD</code> is relaxed in $\small\text{Datalog}^{\lor}$ to allow more than one atom in a rule’s head.</p>
<h2 id="with-functional-dependencies"><a class="header" href="#with-functional-dependencies">With Functional Dependencies</a></h2>
<pre><code class="language-datalog">.assert employee(ein: integer, name: string, ssn: string, active: bool).
.fd employee: ein --&gt; ssn.
.fd employee: ein --&gt; 2, 4. 
</code></pre>
<dl class="enum">
    <dt>ERR_INVALID_ATTRIBUTE_INDEX</dt>
    <dd>
        <p>The integer index in the functional dependency specification is not a valid attribute index in the relation. </p> 
        <p>For example, in <code>.fd employee: employee_id --> ssn.</code> the attribute label <code>employee_id</code> is invalid.</p>
    </dd>
    <dt>ERR_INVALID_ATTRIBUTE_LABEL</dt>
    <dd>
        <p>The predicate in the functional dependency specification is not a valid attribute label in the relation.</p> 
        <p>For example, in <code>.fd employee: ein --> 2, 24.</code> the index <code>24</code> is invalid.</p>
    </dd>
</dl>
<p>The error <code>ERR_PREDICATE_NOT_AN_EXTENSIONAL_RELATION</code> is raised if the relation predicate in the processing instruction has not been asserted as an extensional relation.</p>
<hr />
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>From The Open Group <a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html">man page</a> for the <code>open()</code> function.</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="security-considerations"><a class="header" href="#security-considerations">Security Considerations</a></h1>
<p>See, Security Considerations in <a href="vnd_datalog_text/x_iana.html">IANA Considerations</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="appendix-internationalization-considerations"><a class="header" href="#appendix-internationalization-considerations">Appendix: Internationalization Considerations</a></h1>
<h2 id="identifier-characters"><a class="header" href="#identifier-characters">Identifier Characters</a></h2>
<p>The characters allowed in labeling relations, attributes, facts, atoms, and variables are taken from a broad set of Unicode by category rather than by codepoint range. The following are the definitions of the lexical productions, showing their relation to defined categories.</p>
<pre><code class="language-ebnf">SPACE_SEP
        ::= ? corresponds to the Unicode category 'Zs' ? ;
LC_ALPHA
        ::= ? corresponds to the Unicode category 'Ll' ? ;
UC_ALPHA
        ::= ? corresponds to the Unicode category 'Lu' ? ;
TC_ALPHA
        ::= ? corresponds to the Unicode category 'Lt' ? ;
ALPHA   ::= LC_ALPHA | UC_ALPHA | TC_ALPHA ;
</code></pre>
<p>The following productions are the key <em>identifier</em>-like values, built almost entirely from the character productions above with the addition of the single “_” underscore.</p>
<pre><code class="language-ebnf">predicate
        ::= LC_ALPHA  ( ALPHA | DIGIT | &quot;_&quot; )* ;
named-variable
        ::= UC_ALPHA  ( ALPHA | DIGIT | &quot;_&quot; )* ;
identifier-string
        ::= predicate ( &quot;:&quot; ALPHA ( ALPHA | DIGIT | &quot;_&quot; )* )? ;
</code></pre>
<h2 id="numerical-values"><a class="header" href="#numerical-values">Numerical Values</a></h2>
<p>Numerical values use the following lexical production that allows a number of language representations of the digits 0 to 9. For example, “123”, “١٢٣” (Arabic-Indic), or “१२३” (Devangari).</p>
<pre><code class="language-ebnf">DIGIT   ::= ? corresponds to the Unicode category 'Nd' (decimal number) ? ;
</code></pre>
<p>The only exception to this broad inclusive approach is the definition of the <code>HEXDIGIT</code> production where the Anglo-centric approach is commonly understood and alternate forms may cause confusion.</p>
<pre><code class="language-ebnf">HEXDIGIT
        ::= [0-9a-fA-F] ;
</code></pre>
<h2 id="unicode-operators"><a class="header" href="#unicode-operators">Unicode Operators</a></h2>
<p>The following operators, or syntax symbols, are defined in this specification. Where Unicode symbols are defined for the symbol these are described by codepoint value and assigned name.</p>
<table><thead><tr><th>Symbol</th><th>Primary</th><th>Alternate</th><th>Unicode</th><th>Codepoint</th><th>Name</th></tr></thead><tbody>
<tr><td>Material implication</td><td><code>:-</code></td><td><code>&lt;-</code></td><td><code>←</code></td><td>U+E28690</td><td>LEFTWARDS ARROW</td></tr>
<tr><td>Conjunction</td><td><code>,</code></td><td><code>&amp;</code>, <code>AND</code></td><td><code>∧</code></td><td>U+E288A7</td><td>LOGICAL AND</td></tr>
<tr><td>True (boolean)</td><td><code>true</code></td><td></td><td><code>⊤</code></td><td>U+E28AA4</td><td>DOWN TACK</td></tr>
<tr><td>False (boolean)</td><td><code>false</code></td><td></td><td><code>⊥</code></td><td>U+E28AA5</td><td>UP TACK</td></tr>
<tr><td>Logical negation</td><td><code>!</code></td><td><code>NOT</code></td><td><code>￢</code></td><td>U+EFBFA2</td><td>FULLWIDTH NOT SIGN</td></tr>
<tr><td>Disjunction</td><td><code>;</code></td><td><code>|</code>, <code>OR</code></td><td><code>∨</code></td><td>U+E2BBA8</td><td>LOGICAL OR</td></tr>
<tr><td>Tautology</td><td>N/A</td><td></td><td><code>⊤</code></td><td>U+E28AA4</td><td>DOWN TACK</td></tr>
<tr><td>Absurdity</td><td></td><td></td><td><code>⊥</code></td><td>U+E28AA5</td><td>UP TACK</td></tr>
<tr><td>Equal</td><td><code>=</code></td><td></td><td></td><td>U+3D</td><td>EQUALS SIGN</td></tr>
<tr><td>Not equal</td><td><code>!=</code></td><td><code>/=</code></td><td><code>≠</code></td><td>U+E289A0</td><td>NOT EQUAL TO</td></tr>
<tr><td>Less Than</td><td><code>&lt;</code></td><td></td><td></td><td>U+3C</td><td>LESS-THAN SIGN</td></tr>
<tr><td>Less than, or equal</td><td><code>&lt;=</code></td><td></td><td><code>≤</code></td><td>U+E289A4</td><td>LESS-THAN OR EQUAL TO</td></tr>
<tr><td>Greater than</td><td><code>&gt;</code></td><td></td><td></td><td>U+3E</td><td>GREATER-THAN SIGN</td></tr>
<tr><td>Greater than, or equal</td><td><code>&gt;=</code></td><td></td><td><code>≥</code></td><td>U+E289A5</td><td>GREATER-THAN OR EQUAL TO</td></tr>
<tr><td>String match</td><td><code>*=</code></td><td><code>MATCH</code></td><td><code>≛</code></td><td>U+E2899B</td><td>STAR EQUALS</td></tr>
<tr><td>Functional dependency</td><td><code>--&gt;</code></td><td></td><td><code>⟶</code></td><td>U+E29FB6</td><td>LONG RIGHTWARDS ARROW</td></tr>
</tbody></table>
<p>The following table describes the symbols introduced by different Datalog languages. Note that only material implication, conjunction, true, and false, are required by the initial language $\small\text{Datalog}$.</p>
<table><thead><tr><th>Language</th><th>Introduces</th><th>Symbols</th></tr></thead><tbody>
<tr><td>$\small\text{Datalog}^{\lnot}$</td><td>negation of literals in rule bodies</td><td><code>!</code>, <code>NOT</code>, <code>￢</code></td></tr>
<tr><td>$\small\text{Datalog}^{\lor}$</td><td>disjunction in rule heads</td><td><code>;</code>, <code>|</code>, <code>OR</code>, <code>∨</code></td></tr>
<tr><td>$\small\text{Datalog}^{\bot}$</td><td>rules as constraints, i.e. no body</td><td><code>⊤</code></td></tr>
<tr><td>$\small\text{Datalog}^{\Gamma}$</td><td>typed attributes for relations</td><td>N/A</td></tr>
<tr><td>$\small\text{Datalog}^{\theta}$</td><td>arithmetic literals in rule bodies</td><td><code>=</code>, <code>!=</code>, <code>≠</code>, &lt;<code>, </code>&lt;=<code>, </code>≤<code>, </code>&gt;<code>, </code>&gt;=<code>, </code>≥<code>, </code>*=<code>, </code>≛`</td></tr>
<tr><td>$\small\text{Datalog}^{\rightarrow}$</td><td>functional dependency processing instruction</td><td><code>--&gt;</code>, <code>⟶</code></td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="appendix-ebnf"><a class="header" href="#appendix-ebnf">Appendix: EBNF</a></h1>
<p>The EBNF used here is defined in XML 1.0 <span class="bibref inline"><a href="vnd_datalog_text/x_references.html#EBNF-NOTATION">EBNF-NOTATION</a></span> with the addition that each rule in the grammar ends with a semicolon character <code>;</code>.</p>
<pre><code class="language-ebnf">program ::= processing-instruction* ( fact | rule | query )* ;

/* ************************************************************************* */

fact    ::= predicate ( &quot;(&quot; constant ( &quot;,&quot; constant )* &quot;)&quot; )? &quot;.&quot; ;

predicate
        ::= LC_ALPHA ( ALPHA | DIGIT | &quot;_&quot; )* ;

/* ************************************************************************* */

constant
        ::= string | number | boolean ;

string  ::= identifier-string | literal-string ;

identifier-string
        ::= predicate ( &quot;:&quot; ALPHA ( ALPHA | DIGIT | &quot;_&quot; )* )? ;

literal-string
        ::= DQUOTE ( string-escape | [^#x22] )* DQUOTE ;

string-escape
        ::= &quot;\\&quot; ( DQUOTE | [tnr] )
        | &quot;\u{&quot; HEXDIGIT HEXDIGIT HEXDIGIT HEXDIGIT
              ( HEXDIGIT HEXDIGIT HEXDIGIT HEXDIGIT )? &quot;}&quot; ;

number  ::= float | decimal | integer ;

integer ::= ( &quot;+&quot; | &quot;-&quot; )? DIGIT+ ;

decimal ::= integer &quot;.&quot; DIGIT+ ;

float   ::= decimal ( &quot;e&quot; | &quot;E&quot; ) integer ;

boolean ::= ( &quot;true&quot; | &quot;⊤&quot; ) | ( &quot;false&quot; | &quot;⊥&quot; ) ;

/* ************************************************************************* */

rule    ::= ( head | &quot;⊥&quot; )? ( &quot;:-&quot; | &quot;&lt;-&quot; | &quot;⟵&quot; ) body &quot;.&quot; ;

head    ::= ( atom ( ( &quot;;&quot; | &quot;|&quot; | &quot;OR&quot; | &quot;∨&quot; ) atom )* ) ;

body    ::= literal ( ( &quot;,&quot; | &quot;&amp;&quot; | &quot;AND&quot; | &quot;∧&quot; ) literal )* ;

/* ************************************************************************* */

atom    ::= predicate &quot;(&quot; term ( &quot;,&quot; term )* &quot;)&quot; ;

term    ::= variable | constant ;

variable
        ::= named-variable | anon-variable ;

named-variable
        ::= UC_ALPHA ( ALPHA | DIGIT | &quot;_&quot; )* ;

anon-variable
        ::= &quot;_&quot; ;

/* ************************************************************************* */

literal ::= ( &quot;!&quot; | &quot;NOT&quot; | &quot;￢&quot; )?
            ( relational-literal | arithmetic-literal ) ;

/* ************************************************************************* */

relational-literal
        ::= atom ;

arithmetic-literal
        ::= operand operator operand ;

operand ::= ( named-variable | constant ) ;

operator
        ::= &quot;=&quot;
            | (&quot;!=&quot; | &quot;/=&quot; | &quot;≠&quot;)
            | &quot;&lt;&quot;
            | (&quot;&lt;=&quot; | &quot;≤&quot;)
            | &quot;&gt;&quot;
            | (&quot;&gt;=&quot; | &quot;≥&quot;)
            | (&quot;*=&quot; | &quot;≛&quot; | &quot;MATCHES&quot;) ;

/* ************************************************************************* */

query   ::= ( &quot;?-&quot; atom &quot;.&quot; )
        |   ( atom &quot;?&quot; ) ;

/* ************************************************************************* */

processing-instruction
        ::= &quot;.&quot;
            ( pi-feature
            | pi-assert
            | pi-infer
            | pi-fd
            | pi-input
            | pi-output
            | pi-pragma )
            &quot;.&quot; ;

pi-feature
        ::= &quot;feature&quot; &quot;(&quot; feature-id ( &quot;,&quot; feature-id )* &quot;)&quot; ;

feature-id
        ::= &quot;arithmetic_literals&quot;
        |   &quot;constraints&quot;
        |   &quot;disjunction&quot;
        |   &quot;negation&quot;
        |   &quot;functional_dependencies&quot; ;

pi-assert
        ::= &quot;assert&quot; relation-decl ;

relation-decl
        ::= predicate &quot;(&quot; attribute-decl ( &quot;,&quot; attribute-decl )* &quot;)&quot; ;

attribute-decl
        ::= ( predicate &quot;:&quot; )?
            ( &quot;boolean&quot; | &quot;float&quot; | &quot;decimal&quot; | &quot;integer&quot; | &quot;string&quot; ) ;

pi-infer
        ::= &quot;infer&quot; ( relation-decl | &quot;from&quot; predicate ) ;

pi-fd   ::= ( &quot;fd&quot; | &quot;functional_dependency&quot; )
            predicate &quot;:&quot;
            attribute-index-list ( &quot;--&gt;&quot; | &quot;⟶&quot; ) attribute-index-list ;

attribute-index-list
        ::= attribute-index ( &quot;,&quot; attribute-index )* ;

attribute-index
        ::= integer | predicate ;

pi-input
        ::= &quot;input&quot; io-details ;

io-details
        ::= &quot;(&quot; predicate &quot;,&quot; quoted-string
                ( &quot;,&quot; format-spec )?
            &quot;)&quot; ;

format-spec
        ::= quoted-string ( &quot;,&quot; assign-list )? ;

assign-list
        ::= assignment ( &quot;,&quot; assignment )* ;

assignment
        ::= predicate &quot;=&quot; constant ;

pi-output
        ::= &quot;output&quot; io-details ;

pi-pragma
        ::= &quot;pragma&quot; predicate ( &quot;(&quot; assignment-list &quot;)&quot; )? ;

/* ************************************************************************* */

comment ::= line-comment | block-comment ;

line-comment
        ::= &quot;%&quot; [^\r\n]* EOL ;

block-comment
        ::= '/*' ( [^*] | '*'+ [^*/] )* '*'* '*/' ;

/* ************************************************************************* */

EOL     ::= &quot;\n&quot; | &quot;\r&quot; &quot;\n&quot;? ;

SPACE_SEP
        ::= ? corresponds to the Unicode category 'Zs' ? ;

WHITESPACE
        ::= SPACE_SEP | &quot;\t&quot; | EOL ;

DQUOTE  ::= #x22 ;

LC_ALPHA
        ::= ? corresponds to the Unicode category 'Ll' ? ;

UC_ALPHA
        ::= ? corresponds to the Unicode category 'Lu' ? ;

TC_ALPHA
        ::= ? corresponds to the Unicode category 'Lt' ? ;

ALPHA   ::= LC_ALPHA | UC_ALPHA | TC_ALPHA ;

DIGIT   ::= ? corresponds to the Unicode category 'Nd' (decimal number) ? ;

HEXDIGIT
        ::= [0-9a-fA-F] ;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="appendix-iana-considerations"><a class="header" href="#appendix-iana-considerations">Appendix: IANA Considerations</a></h1>
<p>This section has been submitted to the Internet Engineering Steering Group (IESG) for review, approval, and registration with IANA.</p>
<h2 id="applicationvnddatalogtext"><a class="header" href="#applicationvnddatalogtext">application/vnd.datalog+text</a></h2>
<dl>
    <dt>Type name:</dt>
    <dd><code>application</code></dd>
    <dt>Subtype name:</dt>
    <dd><code>vnd.datalog+text</code></dd>
    <dt>Required parameters:</dt>
    <dd>None.</dd>
    <dt>Optional parameters:</dt>
    <dd>
<p><code>features</code></p>
<p>This parameter allows the transport to identify language features used within the representation. The value of this parameter is a comma-separated list of feature identifiers supported by the specification.</p>
<p><code>dialect</code></p>
<p>This parameter identifies the tool which generated the document, there are some existing tools with extensive usage that deviate from this core specification.
</dd>
<dt>Encoding considerations:</dt>
<dd>The content encoding of a Datalog text document is always UTF-8.</dd>
<dt>Security considerations:</dt>
<dd><p>This media type does include program code for a Datalog interpreter to
execute. However, as Datalog is a restricted deductive logic language
it’s execution environment is limited to entailment and query, and not
capable of general purpose programming.</p></p>
<p>The Datalog language does contain references to additional resources
that may be required to complete a program. For example, an "input"
processing instruction will add facts from an external resource (using
IRIs) to an extensional relation whereas the "output" processing
instruction will be some local resource that may be written to. The
ability to include malicious data in an input file is limited by the
supported representations such as CSV. The ability to write to a local
system may be intercepted by a parser to redirect to safe locations,
and as such the allowed reference is always relative.</p>
<p>This media type requires no privacy or integrity services.This media type does include program code for a Datalog interpreter to
execute. However, as Datalog is a restricted deductive logic language
it's execution environment is limited to entailment and query, and not
capable of general purpose programming.</p>
<p>The Datalog language does contain references to additional resources
that may be required to complete a program. For example, an "input"
processing instruction will add facts from an external resource (using
IRIs) to an extensional relation whereas the "output" processing
instruction will be some local resource that may be written to. The
ability to include malicious data in an input file is limited by the
supported representations such as CSV. The ability to write to a local
system may be intercepted by a parser to redirect to safe locations,
and as such the allowed reference is always relative.</p>
<p>This media type requires no privacy or integrity services.</p></dd>
    <dt>Interoperability considerations:</dt>
    <dd>
A number of vendors have extended Datalog with additional syntax, this has been
a general problem for some years. The introduction of a common standard, and
support for the "dialect" parameter will help clients understand the potential
parsing issues of a specific document.
</>
    <dt>Intended usage:</dt>
    <dd>Common -- For the interchange of Datalog programs.</dd>
    <dt>Applications which use this media:</dt>
    <dd>Applications that need to upload, download, or transfer Datalog programs.</dd>
    <dt>Fragment identifier considerations:</dt>
    <dd>None.</dd>
    <dt>Restrictions on usage:</dt>
    <dd>None.</dd>
    <dt>Published specification:</dt>
    <dd>[https://datalog-specs.info/vnd_datalog_text/abstract.html](https://datalog-specs.info/vnd_datalog_text/abstract.html) (not yet complete)</dd>
    <dt>Additional information:</dt>
    <dd>
        <dl>
            <dt>Magic number(s):</dt>
            <dd>None.</dd>
            <dt>File extension(s):</dt>
            <dd>dl</dd>
            <dt>Macintosh file type code:</dt>
            <dd>TEXT</dd>
        </dl>
    </dd>
    <dt>General Comments:</dt>
    <dd>None.</dd>
    <dt>Provisional registration? (standards tree only):</dt>
    <dd>N/A</dd>
    <dt>Author/Change controller:</dt>
    <dd>N/A</dd>
</dl>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dialect-identifiers"><a class="header" href="#dialect-identifiers">Dialect Identifiers</a></h1>
<p><em>This section is non-normative.</em></p>
<table><thead><tr><th>Identifier</th><th>Tool(s)</th><th>Source</th><th>Normative?</th><th>Date</th></tr></thead><tbody>
<tr><td><code>core</code></td><td>N/A</td><td>This specification</td><td>Yes</td><td>XX March 2022</td></tr>
<tr><td><code>souffle</code></td><td><a href="https://souffle-lang.github.io/">Soufflé</a></td><td></td><td>No</td><td>XX March 2022</td></tr>
</tbody></table>
<p>Note that the absence of the <code>dialect</code> parameter on the MIME type is the same as using the value <code>core</code>. The following values are therefore equivalent.</p>
<pre><code class="language-text">application/vnd.datalog+text
application/vnd.datalog+text;dialect=core
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="appendix-references"><a class="header" href="#appendix-references">Appendix: References</a></h1>
<div class="biblio">
<ol>
<li>
<p><span class="bibkey" id="EBNF-NOTATION">EBNF-NOTATION</span>Tim Bray; Jean Paoli; C. M. Sperberg-McQueen; Eve Maler; François Yergeau. <em><a href="http://www.w3.org/TR/REC-xml/#sec-notation">EBNF Notation</a></em> 26 November 2008. W3C Recommendation. URL: <a href="http://www.w3.org/TR/REC-xml/#sec-notation">http://www.w3.org/TR/REC-xml/#sec-notation</a></p>
</li>
<li>
<p><span class="bibkey" id="IANA-TSV">IANA-TSV</span>P. Lindner, U of MN Internet Gopher Team. <em><a href="https://www.iana.org/assignments/media-types/text/tab-separated-values">Media Type Registration: text/tab-separated-values</a></em>. URL: <a href="https://www.iana.org/assignments/media-types/text/tab-separated-values">https://www.iana.org/assignments/media-types/text/tab-separated-values</a> </p>
</li>
<li>
<p><span class="bibkey" id="RFC1590">RFC1590</span>Postel, J., <em><a href="http://tools.ietf.org/html/rfc1590">Media Type Registration Procedure</a></em>, November 1996. IETF. Internet Standard. URL: <a href="http://tools.ietf.org/html/rfc1590">http://tools.ietf.org/html/rfc1590</a></p>
</li>
<li>
<p><span class="bibkey" id="RFC2119">RFC2119</span>S. Bradner. <em><a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></em>. March 1997. IETF. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a></p>
</li>
<li>
<p><span class="bibkey" id="RFC2616">RFC2616</span>R. Fielding, J. Gettys, J. Mogul, H. Frystyk, L. Masinter, P. Leach, and T. Berners-Lee. <em><a href="https://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol – HTTP/1.1</a></em>. June 1999. IETF. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc2616">https://tools.ietf.org/html/rfc2616</a></p>
</li>
<li>
<p><span class="bibkey" id="RFC3986">RFC3986</span>T. Berners-Lee; R. Fielding; L. Masinter. <em><a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a></em>. January 2005. IETF. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a></p>
</li>
<li>
<p><span class="bibkey" id="RFC4180">RFC4180</span>Y. Shafranovich. <em><a href="https://tools.ietf.org/html/rfc4180">Common Format and MIME Type for Comma-Separated Values (CSV) FilesCommon Format and MIME Type for Comma-Separated Values (CSV) Files</a></em>. October 2005. IETF. Memo. URL: <a href="https://tools.ietf.org/html/rfc4180">https://tools.ietf.org/html/rfc4180</a></p>
</li>
<li>
<p><span class="bibkey" id="RFC4627">RFC4627</span>D. Crockford. <em><a href="https://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a></em>. July 2006. IETF. Memo. URL: <a href="https://tools.ietf.org/html/rfc4627">https://tools.ietf.org/html/rfc4627</a></p>
</li>
<li>
<p><span class="bibkey" id="RFC8174">RFC8174</span>B. Leiba. <em><a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a></em>. May 2017. IETF. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc8174">https://tools.ietf.org/html/rfc8174</a></p>
</li>
<li>
<p><span class="bibkey" id="UNICODE">UNICODE</span><em><a href="http://www.unicode.org/versions/latest/">The Unicode Standard</a></em>. URL: <a href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a></p>
</li>
</ol>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="datalog-text-representation--errata"><a class="header" href="#datalog-text-representation--errata">Datalog Text Representation – Errata</a></h1>
<h2 id="version-xx-march-2022"><a class="header" href="#version-xx-march-2022">Version: XX March 2022.</a></h2>
<p>None.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="datalog-text-representation--translations"><a class="header" href="#datalog-text-representation--translations">Datalog Text Representation – Translations</a></h1>
<h2 id="version-xx-march-2022-1"><a class="header" href="#version-xx-march-2022-1">Version: XX March 2022.</a></h2>
<p>None.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="datalog.js"></script>
        <script type="text/javascript" src="specs.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
